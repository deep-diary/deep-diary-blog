<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>项目管理后台 | Deep Diary</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <script charset="utf-8" src="/js/custom.js"></script>
    <meta name="description" content="基于深度学习，专注于旅游，记忆追溯相关的开发">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification">
    <meta name="keywords" content="深记,deep-diary,自建博客,葛维冬，深度学习，记忆追溯">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="robots" content="all">
    <meta name="author" content="deep-diary">
    
    <link rel="preload" href="/assets/css/0.styles.bfd62ff8.css" as="style"><link rel="preload" href="/assets/js/app.06d47b9d.js" as="script"><link rel="preload" href="/assets/js/4.ddcf94e0.js" as="script"><link rel="preload" href="/assets/js/1.dee964bb.js" as="script"><link rel="preload" href="/assets/js/72.d8fe63a7.js" as="script"><link rel="preload" href="/assets/js/10.51e38269.js" as="script"><link rel="prefetch" href="/assets/js/100.cc9d71a8.js"><link rel="prefetch" href="/assets/js/101.e3bd5405.js"><link rel="prefetch" href="/assets/js/102.37350233.js"><link rel="prefetch" href="/assets/js/103.3634a0fc.js"><link rel="prefetch" href="/assets/js/104.a41513c6.js"><link rel="prefetch" href="/assets/js/105.f0061086.js"><link rel="prefetch" href="/assets/js/106.9f976bce.js"><link rel="prefetch" href="/assets/js/107.0cd16123.js"><link rel="prefetch" href="/assets/js/108.395a29de.js"><link rel="prefetch" href="/assets/js/109.6a6ddea3.js"><link rel="prefetch" href="/assets/js/11.e5b6f4c2.js"><link rel="prefetch" href="/assets/js/110.84e01b0c.js"><link rel="prefetch" href="/assets/js/111.26ca25ac.js"><link rel="prefetch" href="/assets/js/112.03c7ee91.js"><link rel="prefetch" href="/assets/js/113.f5b7b1fe.js"><link rel="prefetch" href="/assets/js/114.8d39fb2b.js"><link rel="prefetch" href="/assets/js/115.f02ad2c4.js"><link rel="prefetch" href="/assets/js/116.245fe9ad.js"><link rel="prefetch" href="/assets/js/12.dac87fca.js"><link rel="prefetch" href="/assets/js/13.d9355def.js"><link rel="prefetch" href="/assets/js/14.11c18bbb.js"><link rel="prefetch" href="/assets/js/15.3c0fabce.js"><link rel="prefetch" href="/assets/js/16.aae16d08.js"><link rel="prefetch" href="/assets/js/17.ab7555cb.js"><link rel="prefetch" href="/assets/js/18.a8c7c83b.js"><link rel="prefetch" href="/assets/js/19.8cfdab67.js"><link rel="prefetch" href="/assets/js/20.bf9d2368.js"><link rel="prefetch" href="/assets/js/21.9ea1cb9f.js"><link rel="prefetch" href="/assets/js/22.4d1d6918.js"><link rel="prefetch" href="/assets/js/23.14c86f96.js"><link rel="prefetch" href="/assets/js/24.ca467894.js"><link rel="prefetch" href="/assets/js/25.a8064bef.js"><link rel="prefetch" href="/assets/js/26.6c7bca23.js"><link rel="prefetch" href="/assets/js/27.3e5e16b9.js"><link rel="prefetch" href="/assets/js/28.7012292b.js"><link rel="prefetch" href="/assets/js/29.b8134971.js"><link rel="prefetch" href="/assets/js/30.12a52950.js"><link rel="prefetch" href="/assets/js/31.369052ad.js"><link rel="prefetch" href="/assets/js/32.27af021f.js"><link rel="prefetch" href="/assets/js/33.b28aec33.js"><link rel="prefetch" href="/assets/js/34.23886262.js"><link rel="prefetch" href="/assets/js/35.b3c3c874.js"><link rel="prefetch" href="/assets/js/36.f348bf29.js"><link rel="prefetch" href="/assets/js/37.5a620585.js"><link rel="prefetch" href="/assets/js/38.29d31ac3.js"><link rel="prefetch" href="/assets/js/39.65361890.js"><link rel="prefetch" href="/assets/js/40.179ec406.js"><link rel="prefetch" href="/assets/js/41.9bed72d5.js"><link rel="prefetch" href="/assets/js/42.2d839aab.js"><link rel="prefetch" href="/assets/js/43.67a8aedc.js"><link rel="prefetch" href="/assets/js/44.13d65b57.js"><link rel="prefetch" href="/assets/js/45.265ac6b1.js"><link rel="prefetch" href="/assets/js/46.cca15f5c.js"><link rel="prefetch" href="/assets/js/47.53d18981.js"><link rel="prefetch" href="/assets/js/48.1e034b86.js"><link rel="prefetch" href="/assets/js/49.cb981183.js"><link rel="prefetch" href="/assets/js/5.58e443fd.js"><link rel="prefetch" href="/assets/js/50.6ef19361.js"><link rel="prefetch" href="/assets/js/51.54700ec6.js"><link rel="prefetch" href="/assets/js/52.cd6dbc38.js"><link rel="prefetch" href="/assets/js/53.8d0de436.js"><link rel="prefetch" href="/assets/js/54.c5ae7152.js"><link rel="prefetch" href="/assets/js/55.ccc3dea6.js"><link rel="prefetch" href="/assets/js/56.04b028cf.js"><link rel="prefetch" href="/assets/js/57.23957fad.js"><link rel="prefetch" href="/assets/js/58.4e79dcf9.js"><link rel="prefetch" href="/assets/js/59.e93f6c5d.js"><link rel="prefetch" href="/assets/js/6.43391b6b.js"><link rel="prefetch" href="/assets/js/60.9c344ac3.js"><link rel="prefetch" href="/assets/js/61.88323317.js"><link rel="prefetch" href="/assets/js/62.e40c814b.js"><link rel="prefetch" href="/assets/js/63.4a58a1fd.js"><link rel="prefetch" href="/assets/js/64.b2022e6d.js"><link rel="prefetch" href="/assets/js/65.d09e6269.js"><link rel="prefetch" href="/assets/js/66.a8c405ce.js"><link rel="prefetch" href="/assets/js/67.478a115f.js"><link rel="prefetch" href="/assets/js/68.ecf97bdf.js"><link rel="prefetch" href="/assets/js/69.eb5d56c7.js"><link rel="prefetch" href="/assets/js/7.706f533b.js"><link rel="prefetch" href="/assets/js/70.c0f22b84.js"><link rel="prefetch" href="/assets/js/71.dbf7b19f.js"><link rel="prefetch" href="/assets/js/73.920ba807.js"><link rel="prefetch" href="/assets/js/74.b08e4984.js"><link rel="prefetch" href="/assets/js/75.ae2555d6.js"><link rel="prefetch" href="/assets/js/76.418a5712.js"><link rel="prefetch" href="/assets/js/77.5a8c2c11.js"><link rel="prefetch" href="/assets/js/78.41ca4c6b.js"><link rel="prefetch" href="/assets/js/79.4b1a0fd7.js"><link rel="prefetch" href="/assets/js/8.5e0abf00.js"><link rel="prefetch" href="/assets/js/80.7e6313de.js"><link rel="prefetch" href="/assets/js/81.10173085.js"><link rel="prefetch" href="/assets/js/82.f23f7400.js"><link rel="prefetch" href="/assets/js/83.03fe8284.js"><link rel="prefetch" href="/assets/js/84.09f83631.js"><link rel="prefetch" href="/assets/js/85.838a4090.js"><link rel="prefetch" href="/assets/js/86.ab5dc24b.js"><link rel="prefetch" href="/assets/js/87.41afbdf2.js"><link rel="prefetch" href="/assets/js/88.58a20fa8.js"><link rel="prefetch" href="/assets/js/89.847595a1.js"><link rel="prefetch" href="/assets/js/9.2d9184d6.js"><link rel="prefetch" href="/assets/js/90.4c2589c1.js"><link rel="prefetch" href="/assets/js/91.17c51f4e.js"><link rel="prefetch" href="/assets/js/92.b8669ba2.js"><link rel="prefetch" href="/assets/js/93.89cad79c.js"><link rel="prefetch" href="/assets/js/94.14f4afb5.js"><link rel="prefetch" href="/assets/js/95.e12718f6.js"><link rel="prefetch" href="/assets/js/96.b08f5b6e.js"><link rel="prefetch" href="/assets/js/97.2078ea59.js"><link rel="prefetch" href="/assets/js/98.7860ab58.js"><link rel="prefetch" href="/assets/js/99.884dd058.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.e51760b9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bfd62ff8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-4698c43e><div data-v-4698c43e><div id="loader-wrapper" class="loading-wrapper" data-v-1c4f0192 data-v-4698c43e data-v-4698c43e><div class="loader-main" data-v-1c4f0192><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-6cbeab0a data-v-4698c43e data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>Deep Diary</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>Blue</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-4698c43e><header class="navbar" data-v-4698c43e><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Deep Diary</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/categories/deep learning/" class="nav-link"><i class="iconfont undefined"></i>
  deep learning
</a></li><li class="dropdown-item"><!----> <a href="/categories/ROS/" class="nav-link"><i class="iconfont undefined"></i>
  ROS
</a></li><li class="dropdown-item"><!----> <a href="/categories/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li><li class="dropdown-item"><!----> <a href="/categories/ros2/" class="nav-link"><i class="iconfont undefined"></i>
  ros2
</a></li><li class="dropdown-item"><!----> <a href="/categories/Develop/" class="nav-link"><i class="iconfont undefined"></i>
  Develop
</a></li><li class="dropdown-item"><!----> <a href="/categories/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li><li class="dropdown-item"><!----> <a href="/categories/guide/" class="nav-link"><i class="iconfont undefined"></i>
  guide
</a></li><li class="dropdown-item"><!----> <a href="/categories/Gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/参考资料/" class="nav-link"><i class="iconfont undefined"></i>
  参考资料
</a></li><li class="dropdown-item"><!----> <a href="/categories/conference/" class="nav-link"><i class="iconfont undefined"></i>
  conference
</a></li><li class="dropdown-item"><!----> <a href="/categories/blog/" class="nav-link"><i class="iconfont undefined"></i>
  blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/vuepress/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress
</a></li><li class="dropdown-item"><!----> <a href="/categories/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/categories/Synology/" class="nav-link"><i class="iconfont undefined"></i>
  Synology
</a></li><li class="dropdown-item"><!----> <a href="/categories/WEB/" class="nav-link"><i class="iconfont undefined"></i>
  WEB
</a></li><li class="dropdown-item"><!----> <a href="/categories/voice/" class="nav-link"><i class="iconfont undefined"></i>
  voice
</a></li><li class="dropdown-item"><!----> <a href="/categories/PM/" class="nav-link"><i class="iconfont undefined"></i>
  PM
</a></li><li class="dropdown-item"><!----> <a href="/categories/project/" class="nav-link"><i class="iconfont undefined"></i>
  project
</a></li><li class="dropdown-item"><!----> <a href="/categories/django/" class="nav-link"><i class="iconfont undefined"></i>
  django
</a></li><li class="dropdown-item"><!----> <a href="/categories/database/" class="nav-link"><i class="iconfont undefined"></i>
  database
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      Guide
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link"><i class="iconfont undefined"></i>
  Guide
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Project
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/management/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  Management
</a></li><li class="dropdown-item"><!----> <a href="/project/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/project/blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Embedded
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Deep Learning
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Deep-Learning/" class="nav-link"><i class="iconfont undefined"></i>
  Deep Learning
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Web
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/Backend/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/mysql/" class="nav-link"><i class="iconfont undefined"></i>
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/web/backend/nginx/" class="nav-link"><i class="iconfont undefined"></i>
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/web/frondend/vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/" class="nav-link"><i class="iconfont undefined"></i>
  Database
</a></li><li class="dropdown-item"><!----> <a href="/web/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Software
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-date"></i>
      Algorithm
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-4698c43e></div> <aside class="sidebar" data-v-4698c43e><div class="personal-info-wrapper" data-v-6c8ffc9c><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-6c8ffc9c> <h3 class="name" data-v-6c8ffc9c>
    Blue
  </h3> <div class="num" data-v-6c8ffc9c><div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>77</h3> <h6 data-v-6c8ffc9c>文章</h6></div> <div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>103</h3> <h6 data-v-6c8ffc9c>标签</h6></div></div> <hr data-v-6c8ffc9c></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/categories/deep learning/" class="nav-link"><i class="iconfont undefined"></i>
  deep learning
</a></li><li class="dropdown-item"><!----> <a href="/categories/ROS/" class="nav-link"><i class="iconfont undefined"></i>
  ROS
</a></li><li class="dropdown-item"><!----> <a href="/categories/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li><li class="dropdown-item"><!----> <a href="/categories/ros2/" class="nav-link"><i class="iconfont undefined"></i>
  ros2
</a></li><li class="dropdown-item"><!----> <a href="/categories/Develop/" class="nav-link"><i class="iconfont undefined"></i>
  Develop
</a></li><li class="dropdown-item"><!----> <a href="/categories/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li><li class="dropdown-item"><!----> <a href="/categories/guide/" class="nav-link"><i class="iconfont undefined"></i>
  guide
</a></li><li class="dropdown-item"><!----> <a href="/categories/Gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/参考资料/" class="nav-link"><i class="iconfont undefined"></i>
  参考资料
</a></li><li class="dropdown-item"><!----> <a href="/categories/conference/" class="nav-link"><i class="iconfont undefined"></i>
  conference
</a></li><li class="dropdown-item"><!----> <a href="/categories/blog/" class="nav-link"><i class="iconfont undefined"></i>
  blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/vuepress/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress
</a></li><li class="dropdown-item"><!----> <a href="/categories/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/categories/Synology/" class="nav-link"><i class="iconfont undefined"></i>
  Synology
</a></li><li class="dropdown-item"><!----> <a href="/categories/WEB/" class="nav-link"><i class="iconfont undefined"></i>
  WEB
</a></li><li class="dropdown-item"><!----> <a href="/categories/voice/" class="nav-link"><i class="iconfont undefined"></i>
  voice
</a></li><li class="dropdown-item"><!----> <a href="/categories/PM/" class="nav-link"><i class="iconfont undefined"></i>
  PM
</a></li><li class="dropdown-item"><!----> <a href="/categories/project/" class="nav-link"><i class="iconfont undefined"></i>
  project
</a></li><li class="dropdown-item"><!----> <a href="/categories/django/" class="nav-link"><i class="iconfont undefined"></i>
  django
</a></li><li class="dropdown-item"><!----> <a href="/categories/database/" class="nav-link"><i class="iconfont undefined"></i>
  database
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      Guide
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link"><i class="iconfont undefined"></i>
  Guide
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Project
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/management/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  Management
</a></li><li class="dropdown-item"><!----> <a href="/project/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/project/blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Embedded
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Deep Learning
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Deep-Learning/" class="nav-link"><i class="iconfont undefined"></i>
  Deep Learning
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Web
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/Backend/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/mysql/" class="nav-link"><i class="iconfont undefined"></i>
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/web/backend/nginx/" class="nav-link"><i class="iconfont undefined"></i>
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/web/frondend/vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/" class="nav-link"><i class="iconfont undefined"></i>
  Database
</a></li><li class="dropdown-item"><!----> <a href="/web/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Software
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-date"></i>
      Algorithm
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Management</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Project/management/" aria-current="page" class="sidebar-link">Introduction of Project Management</a></li><li><a href="/Project/management/blow molding process.html" class="sidebar-link">吹塑工艺简介</a></li><li><a href="/Project/management/hot plate welding.html" class="sidebar-link">热板焊工艺</a></li><li><a href="/Project/management/tesla manifold.html" class="sidebar-link">水冷歧管-Coolant Manifold</a></li><li><a href="/Project/management/项目管理后台.html" class="active sidebar-link">项目管理后台</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Project/management/项目管理后台.html#创建app" class="sidebar-link">创建app</a></li><li class="sidebar-sub-header"><a href="/Project/management/项目管理后台.html#创建模型" class="sidebar-link">创建模型</a></li><li class="sidebar-sub-header"><a href="/Project/management/项目管理后台.html#将模型添加到admin中" class="sidebar-link">将模型添加到admin中</a></li><li class="sidebar-sub-header"><a href="/Project/management/项目管理后台.html#创建序列化器" class="sidebar-link">创建序列化器</a></li><li class="sidebar-sub-header"><a href="/Project/management/项目管理后台.html#视图集" class="sidebar-link">视图集</a></li></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-6cbeab0a data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>项目管理后台</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>Blue</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2023
        </a></span></div></div> <div data-v-4698c43e><main class="page"><!----> <div class="page-title" style="display:none;"><h1>项目管理后台</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>Blue</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2022-08-14</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      project
    </span><span class="tag-item" data-v-484a899e>
      management
    </span><span class="tag-item" data-v-484a899e>
      django
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p class="custom-block-title">说明</p> <p>做汽车行业的项目，有时候往往项目多大十几个，零件多达几十个，很难光靠记忆记住所有的东西，因此期望做一个项目管理后台，便于统计相关项目，工检模进度，模具履历等</p> <p><a href="www.deep-diary.com">点击免费观看教学视频</a></p></div> <h1 id="项目管理">项目管理</h1> <h2 id="创建app">创建app</h2> <p>首先在命令行创建项目的 App：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> <span class="token operator">&gt;</span> python manage.py startapp project
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>再在全局设置中添加应用</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># setting</span>

INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">'project'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="创建模型">创建模型</h2> <h3 id="定义模型">定义模型</h3> <p>首先，我们需要理清业务逻辑结构，然后再根据这个结构，定义模型</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650153422794.png" alt="1650153422794"></p> <h3 id="人员模型">人员模型</h3> <p>人员模型，跟会员模型整合到了一起，定义在<code>profile</code>模型中。</p> <p>同时，在<code>user_info</code>应用中，增加了公司模型，作为人员的上一级模型</p> <h3 id="项目模型">项目模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 项目 model</span>
<span class="token keyword">class</span> <span class="token class-name">Project</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    CUSTOM_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;GM&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;TESLA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;大众&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;吉利&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;长城&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;蔚来&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;舍弗勒&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&quot;哪吒&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;零跑&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">&quot;其它&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    PRODUCT_DIFFICULT_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;溢水灌&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;溢水灌盖子新开&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;洗涤壶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;膨胀箱&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;歧管&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    LINE_DIFFICULT_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;沿用产线&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;新开发产线50万内&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;新开发产线超50万&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    FIXTURE_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;1套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;2套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;3套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;4套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;5套及以上&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    GAUGE_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;1套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;2套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;3套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;4套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;5套及以上&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    TOOLING_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;1套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;2套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;3套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;4套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;5套及以上&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    PURCHASE_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;1套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;2套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;3套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;4套&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;5套及以上&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    custom <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>CUSTOM_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;客户&quot;</span><span class="token punctuation">,</span>
                                      help_text<span class="token operator">=</span><span class="token string">&quot;客户名称&quot;</span><span class="token punctuation">)</span>
    prg_code <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;项目代号&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;客户项目代码&quot;</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;项目名称&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目名称&quot;</span><span class="token punctuation">)</span>
    team <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span>to<span class="token operator">=</span>Staff<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;项目团队&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目团队&quot;</span><span class="token punctuation">)</span>
    pls_sn <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;PLM项目号&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;PLM创建的唯一项目号&quot;</span><span class="token punctuation">)</span>
    volume <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;年产量&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目预测年产量&quot;</span><span class="token punctuation">)</span>
    percent <span class="token operator">=</span> models<span class="token punctuation">.</span>FloatField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;当前进度&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目当前的时间进度，仅仅从时间角度考虑&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># 客户关键节点</span>
    kick_off <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;项目启动时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目启动时间&quot;</span><span class="token punctuation">)</span>
    t0_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;首件交样时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首件交样时间&quot;</span><span class="token punctuation">)</span>
    ots_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;工装样件&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;正常产线生产出来零件的时间&quot;</span><span class="token punctuation">)</span>
    ppap <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;PPAP时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;客户批准生产的时间&quot;</span><span class="token punctuation">)</span>
    sop <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;量产时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;客户开始量产时间，这个时候项目必须得移交&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># 内部项目节点</span>
    plm_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;PLM 立项时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;PLM 立项时间&quot;</span><span class="token punctuation">)</span>
    stage1_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;PLM 第一阶段完成时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;PLM 第一阶段完成时间&quot;</span><span class="token punctuation">)</span>
    stage2_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;PLM 第二阶段完成时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;PLM 第二阶段完成时间&quot;</span><span class="token punctuation">)</span>
    stage3_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;PLM 第三阶段完成时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;PLM 第三阶段完成时间&quot;</span><span class="token punctuation">)</span>
    stage4_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;PLM 第四阶段完成时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;PLM 第四阶段完成时间&quot;</span><span class="token punctuation">)</span>
    stage5_tm <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;PLM 第五阶段完成时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;PLM 第五阶段完成时间&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># 项目难度</span>
    Product_difficult <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>PRODUCT_DIFFICULT_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                                 default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;产品难度&quot;</span><span class="token punctuation">,</span>
                                                 help_text<span class="token operator">=</span><span class="token string">&quot;产品难度&quot;</span><span class="token punctuation">)</span>
    line_difficult <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>LINE_DIFFICULT_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                              verbose_name<span class="token operator">=</span><span class="token string">&quot;产线难度&quot;</span><span class="token punctuation">,</span>
                                              help_text<span class="token operator">=</span><span class="token string">&quot;产线难度&quot;</span><span class="token punctuation">)</span>
    Purchase_num <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>PURCHASE_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                            verbose_name<span class="token operator">=</span><span class="token string">&quot;外购件数量&quot;</span><span class="token punctuation">,</span>
                                            help_text<span class="token operator">=</span><span class="token string">&quot;新开发外购件数量，模具另算&quot;</span><span class="token punctuation">)</span>
    Fixture_num <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>FIXTURE_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                           verbose_name<span class="token operator">=</span><span class="token string">&quot;工装数量&quot;</span><span class="token punctuation">,</span>
                                           help_text<span class="token operator">=</span><span class="token string">&quot;工装数量&quot;</span><span class="token punctuation">)</span>
    Gauge_num <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>GAUGE_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;检具数量&quot;</span><span class="token punctuation">,</span>
                                         help_text<span class="token operator">=</span><span class="token string">&quot;检具数量&quot;</span><span class="token punctuation">)</span>
    Tooling_num <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>TOOLING_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                                           verbose_name<span class="token operator">=</span><span class="token string">&quot;模具数量&quot;</span><span class="token punctuation">,</span>
                                           help_text<span class="token operator">=</span><span class="token string">&quot;模具数量&quot;</span><span class="token punctuation">)</span>
    Busy_factor <span class="token operator">=</span> models<span class="token punctuation">.</span>FloatField<span class="token punctuation">(</span>null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;忙碌系数&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;工作强度评价指标&quot;</span><span class="token punctuation">)</span>

    img <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Img<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'project'</span><span class="token punctuation">,</span>
        verbose_name<span class="token operator">=</span><span class="token string">'项目图片'</span><span class="token punctuation">,</span>
        help_text<span class="token operator">=</span><span class="token string">'请上传项目图片'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br></div></div><p>这里涉及到一个新知识点，</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>team <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span>to<span class="token operator">=</span>Staff<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;项目团队&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目团队&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 多对多关系</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>进行数据库迁移后，就会产线如下数据表：</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650158406000.png" alt="1650158406000"></p> <p>虽然我们只创建了2张表，但由于多对多的关系，会额外创建第3张关联表，就是上图的<code>project_project_team</code></p> <p>其中的第一个<code>project</code>是应用名称，第二个是模型名称</p> <p>更多关于多对多的介绍，详解如下链接</p> <blockquote><p><a href="https://blog.csdn.net/momoda118/article/details/121366803" target="_blank" rel="noopener noreferrer">Django的ManyToManyField（多对多）讲解_曲鸟的博客-CSDN博客_django manytomanyfield<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="产品模型">产品模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 产品 model</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    project <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Project<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'product'</span>
    <span class="token punctuation">)</span>
    PN <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;零件号&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;发货零件号&quot;</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">)</span>
    avatar <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Img<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'product'</span><span class="token punctuation">,</span>
        verbose_name<span class="token operator">=</span><span class="token string">'产品图片'</span><span class="token punctuation">,</span>
        help_text<span class="token operator">=</span><span class="token string">'请上传产品图片'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>name

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        get_latest_by <span class="token operator">=</span> <span class="token string">'id'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="工检模模型">工检模模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 工检模 model</span>
<span class="token keyword">class</span> <span class="token class-name">Tooling</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    TOOLING_TYPE_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token string">&quot;工装&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;工装&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;检具&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;检具&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;模具&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    product <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Product<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'tooling'</span>
    <span class="token punctuation">)</span>
    sn <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;编号&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;工检模编号&quot;</span><span class="token punctuation">)</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> choices<span class="token operator">=</span>TOOLING_TYPE_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'模具'</span><span class="token punctuation">,</span>
                            verbose_name<span class="token operator">=</span><span class="token string">&quot;类型&quot;</span><span class="token punctuation">,</span>
                            help_text<span class="token operator">=</span><span class="token string">&quot;工装检具模具类型选择&quot;</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">)</span>
    release <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;下单时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;下发制造任务书的时间&quot;</span><span class="token punctuation">)</span>
    t0 <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;首次测试时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次测试时间&quot;</span><span class="token punctuation">)</span>
    approve <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;认可时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;认可的时间，需要有移交单&quot;</span><span class="token punctuation">)</span>
    avatar <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Img<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'tooling'</span><span class="token punctuation">,</span>
        verbose_name<span class="token operator">=</span><span class="token string">'产品图片'</span><span class="token punctuation">,</span>
        help_text<span class="token operator">=</span><span class="token string">'请上传工检模图片'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    equip_type <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;设备类型&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;设备类型，比如470T&quot;</span><span class="token punctuation">)</span>
    cavity <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;模腔数&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;注塑 1+1; 吹塑 1*1&quot;</span><span class="token punctuation">)</span>
    is_outsource <span class="token operator">=</span> models<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;是否委外&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;工检模是否委外&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>name

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        get_latest_by <span class="token operator">=</span> <span class="token string">'id'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="外购件模型">外购件模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 外购件 model</span>
<span class="token keyword">class</span> <span class="token class-name">Outsourcing</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    TOOLING_TYPE_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token string">&quot;工装&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;工装&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;检具&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;检具&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;模具&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    product <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Product<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'outsourcing'</span>
    <span class="token punctuation">)</span>
    sn <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;编号&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;工检模编号&quot;</span><span class="token punctuation">)</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> choices<span class="token operator">=</span>TOOLING_TYPE_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'模具'</span><span class="token punctuation">,</span>
                            verbose_name<span class="token operator">=</span><span class="token string">&quot;类型&quot;</span><span class="token punctuation">,</span>
                            help_text<span class="token operator">=</span><span class="token string">&quot;工装检具模具类型选择&quot;</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;产品名称&quot;</span><span class="token punctuation">)</span>
    release <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;下单时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;下发制造任务书的时间&quot;</span><span class="token punctuation">)</span>
    t0 <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;首次测试时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次测试时间&quot;</span><span class="token punctuation">)</span>
    approve <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;认可时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;认可的时间，需要有移交单&quot;</span><span class="token punctuation">)</span>
    avatar <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Img<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'outsourcing'</span><span class="token punctuation">,</span>
        verbose_name<span class="token operator">=</span><span class="token string">'产品图片'</span><span class="token punctuation">,</span>
        help_text<span class="token operator">=</span><span class="token string">'请上传工检模图片'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>name

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        get_latest_by <span class="token operator">=</span> <span class="token string">'id'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h3 id="发货模型">发货模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 发货 model</span>
<span class="token keyword">class</span> <span class="token class-name">Delivery</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    product <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Product<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'delivery'</span>
    <span class="token punctuation">)</span>
    po <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;订单编号&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;订单编号&quot;</span><span class="token punctuation">)</span>
    nums <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;采购数量&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;采购数量&quot;</span><span class="token punctuation">)</span>
    required <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;到位时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;要求采购到位时间&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>product<span class="token punctuation">.</span>name

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        get_latest_by <span class="token operator">=</span> <span class="token string">'id'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="采购模型">采购模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 采购 model</span>
<span class="token keyword">class</span> <span class="token class-name">Purchase</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sn <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Outsourcing<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'purchase'</span>
    <span class="token punctuation">)</span>
    nums <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;采购数量&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;采购数量&quot;</span><span class="token punctuation">)</span>
    required <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;到位时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;要求采购到位时间&quot;</span><span class="token punctuation">)</span>
    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>sn<span class="token punctuation">.</span>name

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        get_latest_by <span class="token operator">=</span> <span class="token string">'id'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="履历模型">履历模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 工检模履历 model</span>
<span class="token keyword">class</span> <span class="token class-name">Resume</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sn <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Tooling<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'resume'</span>
    <span class="token punctuation">)</span>
    stage <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;试模阶段&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;试模阶段，比如T0， T1&quot;</span><span class="token punctuation">)</span>
    tryout <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;试模时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;试模时间&quot;</span><span class="token punctuation">)</span>
    operation_card <span class="token operator">=</span> models<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span>upload_to<span class="token operator">=</span><span class="token string">'./temp'</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;注塑工艺卡&quot;</span><span class="token punctuation">,</span>
                                      help_text<span class="token operator">=</span><span class="token string">&quot;注塑工艺卡&quot;</span><span class="token punctuation">)</span>
    dimension_rpt <span class="token operator">=</span> models<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span>upload_to<span class="token operator">=</span><span class="token string">'./temp'</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;尺寸报告&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;尺寸报告&quot;</span><span class="token punctuation">)</span>
    minutes <span class="token operator">=</span> models<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span>upload_to<span class="token operator">=</span><span class="token string">'./temp'</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;会议纪要&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;会议纪要&quot;</span><span class="token punctuation">)</span>
    mdf_rpt <span class="token operator">=</span> models<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span>upload_to<span class="token operator">=</span><span class="token string">'./temp'</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;修模报告&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;修模报告&quot;</span><span class="token punctuation">)</span>
    <span class="token builtin">next</span> <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;下次试模时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;下次试模时间&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>sn<span class="token punctuation">.</span>name

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        get_latest_by <span class="token operator">=</span> <span class="token string">'id'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="问题清单模型">问题清单模型</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 问题清单 model</span>
<span class="token keyword">class</span> <span class="token class-name">Issue</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ISSUE_TYPE_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;开发&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;产品&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;产线&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;采购&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;延期&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;其它&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    project <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Project<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'issue'</span>
    <span class="token punctuation">)</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>ISSUE_TYPE_OPTION<span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;类别&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;问题类别&quot;</span><span class="token punctuation">)</span>
    tags <span class="token operator">=</span> TaggableManager<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;问题标签&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;可以在这里给问题打上关键字，用','隔开&quot;</span><span class="token punctuation">)</span>
    severity <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;严重度&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;问题严重度&quot;</span><span class="token punctuation">)</span>

    desc <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;问题描述&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;问题描述&quot;</span><span class="token punctuation">)</span>
    principal <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        Profile<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">'issue'</span><span class="token punctuation">,</span>
        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;负责人&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;问题负责人&quot;</span>
    <span class="token punctuation">)</span>
    reason <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;问题原因&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;问题原因&quot;</span><span class="token punctuation">)</span>
    action <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;改善措施&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;改善措施&quot;</span><span class="token punctuation">)</span>
    target <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;完成时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;目标完成时间&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># 数据库更新日期</span>
    created_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;首次创建的时间&quot;</span><span class="token punctuation">)</span>
    updated_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;最后更新的时间&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>desc

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        get_latest_by <span class="token operator">=</span> <span class="token string">'id'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="将模型添加到admin中">将模型添加到admin中</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># project/admin.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin

<span class="token comment"># Register your models here.</span>
<span class="token keyword">from</span> project<span class="token punctuation">.</span>models <span class="token keyword">import</span> Project<span class="token punctuation">,</span> Product<span class="token punctuation">,</span> Purchase<span class="token punctuation">,</span> Tooling<span class="token punctuation">,</span> Outsourcing<span class="token punctuation">,</span> Delivery<span class="token punctuation">,</span> Company<span class="token punctuation">,</span> \
    Resume<span class="token punctuation">,</span> Issue

admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token punctuation">[</span>Company<span class="token punctuation">,</span> Project<span class="token punctuation">,</span> Product<span class="token punctuation">,</span> Tooling<span class="token punctuation">,</span> Outsourcing<span class="token punctuation">,</span> Purchase<span class="token punctuation">,</span> Delivery<span class="token punctuation">,</span> Resume<span class="token punctuation">,</span> Issue<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 把这个模型注册到管理后台中</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="启动服务">启动服务</h3> <p>进入后台添加一些数据试试</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>deep_diary<span class="token operator">&gt;</span>python manage.py runserver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650377686887.png" alt="1650377686887"></p> <p>进入后台，一看到<code>FaceLM</code>和<code>FaceInsight</code>都已经加到后台中去了，同时我们尝试添加几张人脸找，OK，一切正常，接下来就好设置序列化器和视图了</p> <h2 id="创建序列化器">创建序列化器</h2> <p>项目管理的层级比较深，如果这个学会了，那应该算算是对序列化器彻底掌握了。</p> <p>我们先来看下层级关系：</p> <blockquote><p>公司</p> <blockquote><p>人员</p> <blockquote><p>项目</p> <blockquote><p>产品</p> <blockquote><p>工检模</p> <blockquote><p>履历</p> <blockquote><p>问题清单</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote> <p>层级已经够深了吧！</p> <p>创建好这些数据库后，我们需要明确一些需求</p> <ul><li>统计一个项目经理正在管理的有多少套模具</li></ul> <p>这里用2种不同的方法进行统计，我们一起来对比下</p> <h3 id="从上到下统计">从上到下统计</h3> <p>从上到下，也就是一对多关系，一个项目经理，管理多个项目，每个项目，有多个产品。。。以此类推</p> <p>这样的统计，我们很自然的就想到了序列化器嵌套的方法，我们先上代码：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># project/serializers.py</span>

<span class="token keyword">class</span> <span class="token class-name">ProjectSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    product <span class="token operator">=</span> ProductSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 序列化器嵌套</span>
    url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'project-detail'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Project
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        
<span class="token keyword">class</span> <span class="token class-name">ProductSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tooling <span class="token operator">=</span> ToolingSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>	<span class="token comment"># 序列化器二次嵌套</span>
    outsourcing <span class="token operator">=</span> OutsourcingSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'product-detail'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Product
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        
<span class="token keyword">class</span> <span class="token class-name">ToolingSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    resume <span class="token operator">=</span> ResumeSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 序列化器三次嵌套	</span>
    url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'tooling-detail'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Tooling
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>OK，这样就已经搞定了，毫无压力。那这样的序列化结果如何呢？</p> <p>浏览器输入</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>api<span class="token operator">/</span>project<span class="token operator">/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输出</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">&quot;next&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
    <span class="token string">&quot;previous&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
    <span class="token string">&quot;results&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token comment"># project 模型</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;product&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  <span class="token comment"># 一级套娃</span>
                <span class="token punctuation">{</span>
                    <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;tooling&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  <span class="token comment"># 二级套娃</span>
                        <span class="token punctuation">{</span>
                            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;resume&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  <span class="token comment"># 三级套娃</span>
                                <span class="token punctuation">{</span>
                                    <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                                    <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/resume/2/&quot;</span><span class="token punctuation">,</span>
                                    <span class="token string">&quot;stage&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;t1&quot;</span><span class="token punctuation">,</span>
                                    <span class="token string">&quot;tryout&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-05-17&quot;</span><span class="token punctuation">,</span>
                                    <span class="token string">&quot;operation_card&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
                                    <span class="token string">&quot;dimension_rpt&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
                                    <span class="token string">&quot;minutes&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
                                    <span class="token string">&quot;mdf_rpt&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
                                    <span class="token string">&quot;next&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-06-17&quot;</span><span class="token punctuation">,</span>
                                    <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:36:56.815297+08:00&quot;</span><span class="token punctuation">,</span>
                                    <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:36:56.816258+08:00&quot;</span><span class="token punctuation">,</span>
                                    <span class="token string">&quot;sn&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span>
                                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/tooling/1/&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;sn&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;AT21037&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;壶体吹塑模具&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;release&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;t0&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;approve&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-06-17&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;equip_type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;470T&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;cavity&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;is_outsource&quot;</span><span class="token punctuation">:</span> false<span class="token punctuation">,</span>
                            <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:23:06.055674+08:00&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:23:06.055674+08:00&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;product&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">:</span> null
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;outsourcing&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  <span class="token comment"># 二级套娃</span>
                        <span class="token punctuation">{</span>
                            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/outsourcing/1/&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;sn&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;XD1120-120&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;EPDM 管路&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;release&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;t0&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;approve&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-07-17&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:31:02.694525+08:00&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:31:02.694525+08:00&quot;</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;product&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                            <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">:</span> null
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/product/1/&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;PN&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;84977177&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;洗涤壶总成&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:21:18.129517+08:00&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:21:18.129517+08:00&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;project&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">:</span> null
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/project/1/&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;custom&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;prg_code&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;E2QL&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;洗涤系统总成&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;pls_sn&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;666666&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;volume&quot;</span><span class="token punctuation">:</span> <span class="token number">65000</span><span class="token punctuation">,</span>
            <span class="token string">&quot;percent&quot;</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
            <span class="token string">&quot;kick_off&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;t0_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;ots_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;ppap&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;sop&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;plm_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;stage1_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;stage2_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;stage3_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;stage4_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;stage5_tm&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;Product_difficult&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
            <span class="token string">&quot;line_difficult&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
            <span class="token string">&quot;Purchase_num&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
            <span class="token string">&quot;Fixture_num&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
            <span class="token string">&quot;Gauge_num&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
            <span class="token string">&quot;Tooling_num&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
            <span class="token string">&quot;Busy_factor&quot;</span><span class="token punctuation">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:18:57.342538+08:00&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-19T19:45:13.533345+08:00&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;prg_manager&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
            <span class="token string">&quot;team&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token number">15</span><span class="token punctuation">,</span>
                <span class="token number">14</span><span class="token punctuation">,</span>
                <span class="token number">2</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br></div></div><p>一共三级套娃，是不是看得有些眼花。</p> <p>嵌套序列化器的特点：</p> <ul><li>一级还是可以接受的，到3级，哪些无关紧要的信息就太多了</li> <li>每一级都是树形分叉的，如果平均一个子模型有10条数据，那三级就是1000条。。。</li></ul> <p>注：要实现上述的输出结果，还需要在<code>project.view.py</code>编写视图函数，在<code>urls</code>主路由中配置相关路由，这些后续再进行介绍。</p> <h4 id="从下到上统计">从下到上统计</h4> <p>好的，了解了从上到下序列化器的缺点后，我们来看下从下到上的序列化器如何？</p> <p>所谓从下到上，就是从子模型出发，然后不断的往上，找到唯一的父模型中的字段，先上代码：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># project/serializers.py</span>
<span class="token keyword">class</span> <span class="token class-name">ToolingReportSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    PN <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;product.PN&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 父级模型</span>
    product_name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;product.name&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 爷级模型</span>

    prg_code <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;product.project.prg_code&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 爷级模型</span>
    project_name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;product.project.name&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 爷级模型</span>

    manager <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;product.project.prg_manager.name&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 祖父级模型</span>

    url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'tooling-detail'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Tooling
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>浏览器输入</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>api<span class="token operator">/</span>project<span class="token operator">/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输出</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">&quot;next&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
    <span class="token string">&quot;previous&quot;</span><span class="token punctuation">:</span> null<span class="token punctuation">,</span>
    <span class="token string">&quot;results&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string">&quot;PN&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;84977177&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;product_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;洗涤壶总成&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;prg_code&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;E2QL&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;project_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;洗涤系统总成&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;manager&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;deep-diary&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/tooling/2/&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;sn&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;gz-111111111&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;工装&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;密封测试工装&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;release&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;t0&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;approve&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-06-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;equip_type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;cavity&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;is_outsource&quot;</span><span class="token punctuation">:</span> false<span class="token punctuation">,</span>
            <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:23:46.418341+08:00&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:23:46.418341+08:00&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;product&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">:</span> null
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;PN&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;84977177&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;product_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;洗涤壶总成&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;prg_code&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;E2QL&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;project_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;洗涤系统总成&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;manager&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;deep-diary&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/tooling/1/&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;sn&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;AT21037&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;壶体吹塑模具&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;release&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;t0&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;approve&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-06-17&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;equip_type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;470T&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;cavity&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;吹塑1*1&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;is_outsource&quot;</span><span class="token punctuation">:</span> false<span class="token punctuation">,</span>
            <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:23:06.055674+08:00&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-17T13:23:06.055674+08:00&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;product&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">:</span> null
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>怎么样，现在只有一个级别了，是不是清爽多了，而且，这里最高一级，是项目经理<code>manager</code>,如果再往上找，可以找到其所在公司及地址等信息。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>manager <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;product.project.prg_manager.company.addr&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 我是爷爷的爷爷界别的模型</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="source-用法总结">source 用法总结</h3> <p><code>source</code>这个属性用起来还是很方便的，这里就简单总结以下</p> <h4 id="修改返回到前端的字段名">修改返回到前端的字段名</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code>返回前端的字段 <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;模型中的字段&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 使用source 改名</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="指定模型中的方法">指定模型中的方法</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">ProjectSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    products <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 2. 使用source选项 直接指定本模型中的方法</span>
    url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'project-detail'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>模型中的方法定义如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 项目 model</span>
<span class="token keyword">class</span> <span class="token class-name">Project</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 在模型中定义方法，所返回的字段，可以自由拼接</span>
        queryset <span class="token operator">=</span> self<span class="token punctuation">.</span>product<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取所有子对象</span>
        ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">&quot;PN&quot;</span><span class="token punctuation">:</span> item<span class="token punctuation">.</span>PN<span class="token punctuation">}</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> queryset<span class="token punctuation">]</span>
        <span class="token keyword">return</span> ret

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>输出结果如下</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;products&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;[{'name': '加液管总成', 'PN': '84977176'}, {'name': '洗涤壶总成', 'PN': '84977177'}]&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 方法返回的结果</span>
            <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/project/1/&quot;</span><span class="token punctuation">,</span>
    		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="指定外键字段">指定外键字段</h4> <p>这个功能，就是上一小节中从下到上统计的功能</p> <h3 id="上下级映射序列化器模板">上下级映射序列化器模板</h3> <p>一般的序列化器包含2种，一种是<strong>列表</strong> ，另外一种是<strong>详情</strong>。</p> <p><strong>列表</strong>往往只展示一些比较关键的信息，供上级序列化器调用</p> <p><strong>详情</strong>一般展示所有跟这个模型相关的信息，一般用<code>__all__</code>, 或者<code>exclude</code>进行表达。同时，一般会增加父级模型的一些关键信息，还有子级模型的各条数据</p> <p>具体可以参考如下代码：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">ProjectSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 父级属性</span>
    custom <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;company.name&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 除非特别需要，一般列表中只指定本级字段</span>
    <span class="token comment"># 本级属性</span>
    project_url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'project-detail'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Project
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'custom'</span><span class="token punctuation">,</span> <span class="token string">'prg_code'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'project_url'</span><span class="token punctuation">]</span>


<span class="token keyword">class</span> <span class="token class-name">ProjectDetailSerializer</span><span class="token punctuation">(</span>ProjectSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 继承本级属性</span>
    <span class="token comment"># 父级属性</span>
    <span class="token comment"># prg_manager_url = serializers.HyperlinkedIdentityField(view_name='profile-detail')  # 这个超链接只能链接到本级，链接到上级会造成错乱，因为传入的pk值是本级的</span>
    manager_name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;profile.name&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment"># 子级属性：一对多</span>
    product <span class="token operator">=</span> ProductSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 这里一定要和related 名字一样</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Project
        <span class="token comment"># fields = '__all__'</span>
        exclude <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'created_at'</span><span class="token punctuation">,</span> <span class="token string">'updated_at'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="多对多序列化器">多对多序列化器</h3> <p>多对多序列化器，实际上跟一对多一样，具体详解如下代码</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">TeamSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 本级属性</span>
    profile_url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'profile-detail'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Profile
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'position'</span><span class="token punctuation">,</span> <span class="token string">'avatar'</span><span class="token punctuation">,</span> <span class="token string">'profile_url'</span><span class="token punctuation">]</span>


<span class="token keyword">class</span> <span class="token class-name">ProjectDetailSerializer</span><span class="token punctuation">(</span>ProjectSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 继承本级属性</span>
    <span class="token comment"># 父级属性</span>
    profile <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">&quot;profile.__str__&quot;</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment"># 子级属性：一对多</span>
    product <span class="token operator">=</span> ProductSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    team <span class="token operator">=</span> TeamSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 多对多序列化器，实际上跟一对多一样，这里的team是Project 模型中多对多的外键</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Project
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        <span class="token comment"># exclude = ['created_at', 'updated_at']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="获取模型中的choices对应的值">获取模型中的<code>choices</code>对应的值</h3> <h4 id="方式1-在-str-函数反馈">方式1：在<code>__str__</code>函数反馈</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code>    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>tooling<span class="token punctuation">.</span>sn<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>tooling<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>get_stage_display<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span>  
    <span class="token comment"># 这里的stage换成带有choice 的字段</span>

    stage <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>STAGE_OPTION<span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;试模阶段&quot;</span><span class="token punctuation">,</span>
                             help_text<span class="token operator">=</span><span class="token string">&quot;试模阶段，比如T0， T1&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="方式2-复写类">方式2：复写类</h4> <p>重写<code>ChoiceField</code>的<code>to_representation</code>表现方式：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 由于这个类是公用的，可以为其单独创建一个序列化器文件</span>
<span class="token comment"># 比如utils/serializers.py</span>
<span class="token keyword">class</span> <span class="token class-name">DisplayChoiceField</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ChoiceField<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 获取choice 属性值方式一, 重写Field 类</span>

    <span class="token keyword">def</span> <span class="token function">to_representation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;返回选项的值&quot;&quot;&quot;</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_choices<span class="token punctuation">[</span>obj<span class="token punctuation">]</span>


<span class="token keyword">class</span> <span class="token class-name">ProjectDetailSerializer</span><span class="token punctuation">(</span>ProjectSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>

    line_difficult <span class="token operator">=</span> DisplayChoiceField<span class="token punctuation">(</span>choices<span class="token operator">=</span>LINE_DIFFICULT_OPTION<span class="token punctuation">)</span>  <span class="token comment"># 获取choice 属性值方式一：指定复写后的choice类</span>

    <span class="token comment"># line_difficult = serializers.SerializerMethodField()  # 获取choice 属性值方式二</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Project
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        <span class="token comment"># exclude = ['created_at', 'updated_at']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>重新定义<code>DisplayChoiceField</code>并复写函数</p> <p>需要注意的是<code>LINE_DIFFICULT_OPTION</code>是外部引入的选项元组</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># models.py</span>
LINE_DIFFICULT_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;沿用产线&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;新开发产线50万内&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;新开发产线超50万&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Project</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    line_difficult <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>LINE_DIFFICULT_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;产线难度&quot;</span><span class="token punctuation">,</span>help_text<span class="token operator">=</span><span class="token string">&quot;产线难度&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="方式3-复写get-字段名-相关函数">方式3：复写<code>get_字段名</code> 相关函数</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">ProjectDetailSerializer</span><span class="token punctuation">(</span>ProjectSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>

	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    line_difficult <span class="token operator">=</span> serializers<span class="token punctuation">.</span>SerializerMethodField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 需要这句话</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Project
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        
    <span class="token keyword">def</span> <span class="token function">get_line_difficult</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>	<span class="token comment"># 需要这个函数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 这里的obj，就是Project模型，通过其元数据可以获得一个字段的对象</span>
        <span class="token keyword">return</span> obj<span class="token punctuation">.</span>get_line_difficult_display<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>让我们分析下上面的函数吧：</p> <ul><li><p>这里的obj，就是Project模型，通过其元数据可以获得一个字段的对象</p></li> <li><p><code>dir</code>函数可以获取这个对象所有的属性，具体内容详解如下截图</p></li> <li><p><code>line_difficult</code>对应的是<code>Project</code>下的一个模型字段，可以这样理解</p></li> <li><div class="language-python line-numbers-mode"><pre class="language-python"><code>    <span class="token keyword">def</span> get_模型字段<span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>	<span class="token comment"># 需要这个函数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 这里的obj，就是Project模型，通过其元数据可以获得一个字段的对象</span>
        <span class="token keyword">return</span> obj<span class="token punctuation">.</span>get_模型字段_display<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>所有模型的对象属性</p></li></ul> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650767376330.png" alt="1650767376330"></p> <p>如何把这些字段全部展开，近180个对象属性，这里先贴出来，遇到一个备注一个。</p> <p>值得一提的是，我们定义数据模型的时候，会经常用到<code>verbose_name</code>, <code>help_text</code>等都包含在如下属性中，因此，理解了这些，就可以更加灵活的操作模型对象了。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 模型属性</span>
<span class="token punctuation">[</span>
<span class="token string">'__class__'</span>
<span class="token string">'__copy__'</span>
<span class="token string">'__deepcopy__'</span>
<span class="token string">'__delattr__'</span>
<span class="token string">'__dict__'</span>
<span class="token string">'__dir__'</span>
<span class="token string">'__doc__'</span>
<span class="token string">'__eq__'</span>
<span class="token string">'__format__'</span>
<span class="token string">'__ge__'</span>
<span class="token string">'__getattribute__'</span>
<span class="token string">'__gt__'</span>
<span class="token string">'__hash__'</span>
<span class="token string">'__init__'</span>
<span class="token string">'__init_subclass__'</span>
<span class="token string">'__le__'</span>
<span class="token string">'__lt__'</span>
<span class="token string">'__module__'</span>
<span class="token string">'__ne__'</span>
<span class="token string">'__new__'</span>
<span class="token string">'__reduce__'</span>
<span class="token string">'__reduce_ex__'</span>
<span class="token string">'__repr__'</span>
<span class="token string">'__setattr__'</span>
<span class="token string">'__sizeof__'</span>
<span class="token string">'__str__'</span>
<span class="token string">'__subclasshook__'</span>
<span class="token string">'__weakref__'</span>
<span class="token string">'_check_backend_specific_checks'</span>
<span class="token string">'_check_choices'</span>
<span class="token string">'_check_clashes'</span>
<span class="token string">'_check_db_index'</span>
<span class="token string">'_check_deprecation_details'</span>
<span class="token string">'_check_field_name'</span>
<span class="token string">'_check_null_allowed_for_primary_keys'</span>
<span class="token string">'_check_on_delete'</span>
<span class="token string">'_check_referencing_to_swapped_model'</span>
<span class="token string">'_check_related_name_is_valid'</span>
<span class="token string">'_check_related_query_name_is_valid'</span>
<span class="token string">'_check_relation_model_exists'</span>
<span class="token string">'_check_to_fields_exist'</span>
<span class="token string">'_check_unique'</span>
<span class="token string">'_check_unique_target'</span>
<span class="token string">'_check_validators'</span>
<span class="token string">'_choices_is_value'</span>
<span class="token string">'_clear_cached_lookups'</span>
<span class="token string">'_db_tablespace'</span>
<span class="token string">'_description'</span>
<span class="token string">'_error_messages'</span>
<span class="token string">'_get_default'</span>
<span class="token string">'_get_flatchoices'</span>
<span class="token string">'_get_lookup'</span>
<span class="token string">'_unique'</span>
<span class="token string">'_unregister_lookup'</span>
<span class="token string">'_validators'</span>
<span class="token string">'_verbose_name'</span>
<span class="token string">'attname'</span>
<span class="token string">'auto_created'</span>
<span class="token string">'auto_creation_counter'</span>
<span class="token string">'blank'</span>
<span class="token string">'cached_col'</span>
<span class="token string">'cast_db_type'</span>
<span class="token string">'check'</span>
<span class="token string">'choices'</span>
<span class="token string">'class_lookups'</span>
<span class="token string">'clean'</span>
<span class="token string">'clone'</span>
<span class="token string">'column'</span>
<span class="token string">'concrete'</span>
<span class="token string">'contribute_to_class'</span>
<span class="token string">'contribute_to_related_class'</span>
<span class="token string">'convert_empty_strings'</span>
<span class="token string">'creation_counter'</span>
<span class="token string">'db_check'</span>
<span class="token string">'db_column'</span>
<span class="token string">'db_constraint'</span>
<span class="token string">'db_index'</span>
<span class="token string">'db_parameters'</span>
<span class="token string">'db_returning'</span>
<span class="token string">'db_tablespace'</span>
<span class="token string">'db_type'</span>
<span class="token string">'db_type_parameters'</span>
<span class="token string">'db_type_suffix'</span>
<span class="token string">'deconstruct'</span>
<span class="token string">'default'</span>
<span class="token string">'default_error_messages'</span>
<span class="token string">'default_validators'</span>
<span class="token string">'delete_cached_value'</span>
<span class="token string">'description'</span>
<span class="token string">'descriptor_class'</span>
<span class="token string">'do_related_class'</span>
<span class="token string">'editable'</span>
<span class="token string">'empty_strings_allowed'</span>
<span class="token string">'empty_values'</span>
<span class="token string">'error_messages'</span>
<span class="token string">'flatchoices'</span>
<span class="token string">'foreign_related_fields'</span>
<span class="token string">'formfield'</span>
<span class="token string">'forward_related_accessor_class'</span>
<span class="token string">'from_fields'</span>
<span class="token string">'get_attname'</span>
<span class="token string">'get_attname_column'</span>
<span class="token string">'get_cache_name'</span>
<span class="token string">'get_cached_value'</span>
<span class="token string">'get_choices'</span>
<span class="token string">'get_col'</span>
<span class="token string">'get_db_converters'</span>
<span class="token string">'get_db_prep_save'</span>
<span class="token string">'get_db_prep_value'</span>
<span class="token string">'get_default'</span>
<span class="token string">'get_extra_descriptor_filter'</span>
<span class="token string">'get_extra_restriction'</span>
<span class="token string">'get_filter_kwargs_for_object'</span>
<span class="token string">'get_foreign_related_value'</span>
<span class="token string">'get_forward_related_filter'</span>
<span class="token string">'get_instance_value_for_fields'</span>
<span class="token string">'get_internal_type'</span>
<span class="token string">'get_joining_columns'</span>
<span class="token string">'get_limit_choices_to'</span>
<span class="token string">'get_local_related_value'</span>
<span class="token string">'get_lookup'</span>
<span class="token string">'get_lookups'</span>
<span class="token string">'get_path_info'</span>
<span class="token string">'get_pk_value_on_save'</span>
<span class="token string">'get_prep_value'</span>
<span class="token string">'get_reverse_joining_columns'</span>
<span class="token string">'get_reverse_path_info'</span>
<span class="token string">'get_reverse_related_filter'</span>
<span class="token string">'get_transform'</span>
<span class="token string">'has_default'</span>
<span class="token string">'help_text'</span>
<span class="token string">'hidden'</span>
<span class="token string">'is_cached'</span>
<span class="token string">'is_relation'</span>
<span class="token string">'local_related_fields'</span>
<span class="token string">'many_to_many'</span>
<span class="token string">'many_to_one'</span>
<span class="token string">'max_length'</span>
<span class="token string">'merge_dicts'</span>
<span class="token string">'model'</span>
<span class="token string">'name'</span>
<span class="token string">'null'</span>
<span class="token string">'one_to_many'</span>
<span class="token string">'one_to_one'</span>
<span class="token string">'opts'</span>
<span class="token string">'pre_save'</span>
<span class="token string">'primary_key'</span>
<span class="token string">'register_lookup'</span>
<span class="token string">'rel_class'</span>
<span class="token string">'rel_db_type'</span>
<span class="token string">'related_accessor_class'</span>
<span class="token string">'related_fields'</span>
<span class="token string">'related_model'</span>
<span class="token string">'related_query_name'</span>
<span class="token string">'remote_field'</span>
<span class="token string">'requires_unique_target'</span><span class="token punctuation">,</span><span class="token string">'resolve_related_fields'</span>
<span class="token string">'reverse_related_fields'</span>
<span class="token string">'run_validators'</span>
<span class="token string">'save_form_data'</span>
<span class="token string">'select_format'</span>
<span class="token string">'serialize'</span>
<span class="token string">'set_attributes_from_name'</span>
<span class="token string">'set_attributes_from_rel'</span>
<span class="token string">'set_cached_value'</span>
<span class="token string">'swappable'</span>
<span class="token string">'swappable_setting'</span>
<span class="token string">'system_check_deprecated_details'</span>
<span class="token string">'system_check_removed_details'</span>
<span class="token string">'target_field'</span>
<span class="token string">'to_fields'</span>
<span class="token string">'to_python'</span>
<span class="token string">'unique'</span>
<span class="token string">'unique_for_date'</span>
<span class="token string">'unique_for_month'</span>
<span class="token string">'unique_for_year'</span>
<span class="token string">'validate'</span>
<span class="token string">'validators'</span>
<span class="token string">'value_from_object'</span>
<span class="token string">'value_to_string'</span><span class="token punctuation">,</span><span class="token string">'verbose_name'</span>
<span class="token punctuation">]</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br></div></div><p>接下来，我们来看下跟<code>choices</code>相关的属性</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_line_difficult</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'django.db.models.fields.SmallIntegerField'&gt;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">.</span>choices<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'tuple'&gt;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flatchoices<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'list'&gt;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get_choices<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'method'&gt;</span>
    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>实际上，<code>get_choices</code> 是一个方法，其<code>get_choices()</code>执行结果，等效于<code>flatchoices</code></p> <p>其中20，表示这个属性在模型中的第20个。</p> <p>知道了上述类型后，我们来看下是否可以获取<code>choices</code>中的值呢？</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># project.Project.line_difficult</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">.</span>choices<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># ((2, '沿用产线'), (5, '新开发产线50万内'), (10, '新开发产线超50万'))</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flatchoices<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [(2, '沿用产线'), (5, '新开发产线50万内'), (10, '新开发产线超50万')]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>_meta<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get_choices<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;bound method Field.get_choices of &lt;django.db.models.fields.SmallIntegerField: line_difficult&gt;&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>模型中有各种属性，基于上述结果，完全可以用自己的方法，获取对应的值，这里就不再深入讨论。因此，如果需要获取<code>choices</code>中的数据，实际的代码就是本节刚开始那一段。</p> <h3 id="小结">小结</h3> <p>对于<code>choice</code>选项，一般可以定义为数值型，还可以定义成字符型，两者优缺点整理如下：</p> <ul><li>数值型： 数据库存储空间小，但序列化需要进行额外解析</li> <li>字符型：数据库占用空间大，不方便后续更改维护，优点是序列化过程简单</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>	<span class="token comment"># 字符型</span>
    POSITION_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token string">&quot;项目经理&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;项目经理&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;项目&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;项目&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;质量&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;质量&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;商务&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;商务&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;车间&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;车间&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;工艺&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;工艺&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;模具&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;采购&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;采购&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;物流&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;物流&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;其它&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;其它&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    position <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>choices<span class="token operator">=</span>POSITION_OPTION<span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;其它&quot;</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;岗位&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;请选择该员工岗位&quot;</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 数值型</span>
    POSITION_OPTION <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;项目经理&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;项目&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;质量&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;商务&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;车间&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;工艺&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;模具&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&quot;采购&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;物流&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">&quot;其它&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    position <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>POSITION_OPTION<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;岗位&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;请选择该员工岗位&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>这里推荐都用数值型，结合本节的序列化方法，即可满足应用</p> <p>至于本节的序列化方法，总体来说，第一种方式2更加合适，因为对于第3种，需要对每个字段都进行复写，而第2种方式，复写一个类后，后续字段就可以直接调用了</p> <blockquote><p><a href="https://blog.csdn.net/qq_41854273/article/details/84987899" target="_blank" rel="noopener noreferrer">rest_framework序列化器中ChoiceField的choices显示value代替显示key的方法_Arrowarcher的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="视图集">视图集</h2> <p>刚开始测试的时候，并没有区分列表序列化器和详情序列化器，先把功能快速实现，后续再慢慢优化</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># project/views.py 视图</span>
<span class="token keyword">from</span> django_filters<span class="token punctuation">.</span>rest_framework <span class="token keyword">import</span> DjangoFilterBackend
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets<span class="token punctuation">,</span> filters

<span class="token keyword">from</span> project<span class="token punctuation">.</span>models <span class="token keyword">import</span> Project<span class="token punctuation">,</span> Product<span class="token punctuation">,</span> Tooling<span class="token punctuation">,</span> Issue<span class="token punctuation">,</span> Resume<span class="token punctuation">,</span> Delivery<span class="token punctuation">,</span> Purchase<span class="token punctuation">,</span> Outsourcing
<span class="token keyword">from</span> project<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> ProjectSerializer<span class="token punctuation">,</span> ProductSerializer<span class="token punctuation">,</span> ToolingSerializer<span class="token punctuation">,</span> OutsourcingSerializer<span class="token punctuation">,</span> \
    PurchaseSerializer<span class="token punctuation">,</span> ResumeSerializer<span class="token punctuation">,</span> IssueSerializer<span class="token punctuation">,</span> DeliverySerializer<span class="token punctuation">,</span> ToolingReportSerializer


<span class="token keyword">class</span> <span class="token class-name">ProjectViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Project<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ProjectSerializer
    <span class="token comment"># permission_classes = (AllowAny,)</span>

    filter_backends <span class="token operator">=</span> <span class="token punctuation">[</span>DjangoFilterBackend<span class="token punctuation">,</span> filters<span class="token punctuation">.</span>SearchFilter<span class="token punctuation">,</span> filters<span class="token punctuation">.</span>OrderingFilter<span class="token punctuation">]</span>  <span class="token comment"># 模糊过滤，注意的是，这里的url参数名变成了?search=搜索内容</span>
    <span class="token comment"># filterset_fields = ['user__username', 'tags__name', 'year', 'month', 'day']</span>
    search_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'prg_code'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">]</span>
    ordering_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'prg_code'</span><span class="token punctuation">]</span>  <span class="token comment"># 这里的字段，需要总上面定义字段中选择</span>

    <span class="token comment"># def perform_create(self, serializer):</span>
    <span class="token comment">#     # print(f&quot;INFO:{self.request.user}&quot;)</span>
    <span class="token comment">#     serializer.save(user=self.request.user)</span>
    <span class="token comment">#</span>
    <span class="token comment"># def perform_update(self, serializer):  # 应该在调用的模型中添加</span>
    <span class="token comment">#     instance = serializer.save()  # ProcessedImageField, 也就是ImageField的实例对象</span>
    <span class="token comment">#     if 'tags' in self.request.data:</span>
    <span class="token comment">#         instance.tags.set(self.request.data['tags'].split(','))</span>
    <span class="token comment">#</span>
    <span class="token comment"># def get_serializer_class(self):</span>
    <span class="token comment">#     if self.action == 'list':</span>
    <span class="token comment">#         return ProjectSerializer</span>
    <span class="token comment">#     else:</span>
    <span class="token comment">#         return ProjectSerializer</span>


<span class="token keyword">class</span> <span class="token class-name">ProductViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Product<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ProductSerializer


<span class="token keyword">class</span> <span class="token class-name">ToolingViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Tooling<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># serializer_class = ToolingSerializer</span>
    serializer_class <span class="token operator">=</span> ToolingReportSerializer


<span class="token keyword">class</span> <span class="token class-name">OutsourcingViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Outsourcing<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> OutsourcingSerializer


<span class="token keyword">class</span> <span class="token class-name">PurchaseViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Purchase<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> PurchaseSerializer


<span class="token keyword">class</span> <span class="token class-name">DeliveryViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Delivery<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> DeliverySerializer


<span class="token keyword">class</span> <span class="token class-name">ResumeViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Resume<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ResumeSerializer


<span class="token keyword">class</span> <span class="token class-name">IssueViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Issue<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> IssueSerializer

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h3 id="注册路由">注册路由</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># urls.py 主路由</span>

router <span class="token operator">=</span> DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'project'</span><span class="token punctuation">,</span> ProjectViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'product'</span><span class="token punctuation">,</span> ProductViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'tooling'</span><span class="token punctuation">,</span> ToolingViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'outsourcing'</span><span class="token punctuation">,</span> OutsourcingViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'purchase'</span><span class="token punctuation">,</span> PurchaseViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'delivery'</span><span class="token punctuation">,</span> DeliveryViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'resume'</span><span class="token punctuation">,</span> ResumeViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'issue'</span><span class="token punctuation">,</span> IssueViewSet<span class="token punctuation">)</span>  <span class="token comment"># 新增</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="搜索功能">搜索功能</h3> <p>这里有一个简单的需求，就是通过上诉的序列化器后，我们已经可以统计每套模具对应的所有相关信息，现在我们就需要对此进行过滤，比如：</p> <ul><li>这个项目下有哪几套模具</li> <li>这个项目经理下一共有几套模具，几套工装</li> <li>后续功能比如在众多模具中，那几套已经延期了的</li> <li>。。。</li></ul> <p>根据上诉要求，我们先理理思路</p> <ul><li>模糊搜索是必须的</li> <li>每个模型的外键，肯定是搜索的关键字</li> <li>目前工检模定义在同一个模型中，用<code>type</code>进行区分，因此，这个也是搜索的关键字之一</li></ul> <h4 id="代码解释">代码解释</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">ToolingViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Tooling<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ToolingSerializer
    filter_backends <span class="token operator">=</span> <span class="token punctuation">[</span>DjangoFilterBackend<span class="token punctuation">,</span> filters<span class="token punctuation">.</span>SearchFilter<span class="token punctuation">,</span>
                       filters<span class="token punctuation">.</span>OrderingFilter<span class="token punctuation">]</span>  <span class="token comment"># 模糊过滤，注意的是，这里的url参数名变成了?search=搜索内容</span>
    filterset_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'sn'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'product__name'</span><span class="token punctuation">,</span> <span class="token string">'product__PN'</span><span class="token punctuation">,</span>
                        <span class="token string">'product__project__name'</span><span class="token punctuation">,</span> <span class="token string">'product__project__prg_code'</span><span class="token punctuation">,</span>
                        <span class="token string">'product__project__prg_manager__name'</span><span class="token punctuation">]</span>
    search_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'sn'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'product__name'</span><span class="token punctuation">,</span> <span class="token string">'product__PN'</span><span class="token punctuation">,</span>
                     <span class="token string">'product__project__name'</span><span class="token punctuation">,</span> <span class="token string">'product__project__prg_code'</span><span class="token punctuation">,</span>
                     <span class="token string">'product__project__prg_manager__name'</span><span class="token punctuation">]</span>
    ordering_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span>  <span class="token comment"># 这里的字段，需要总上面定义字段中选择</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>视图中的外键字段，不像序列化器中的一样，直接用<code>.</code>点下去，这里需要用到<code>——</code>双下划线。</p> <p>这里搜索的后端框架，用了2个，可以放在一起使用：</p> <ul><li><code>DjangoFilterBackend</code>, 匹配搜索，<code>url</code>传入<code>?参数名=参数值</code></li> <li><code>filters.SearchFilter</code>，模糊搜索，<code>url</code>传入<code>?search=参数值</code></li></ul> <p>同时用这两个框架的好处就是把您所知道的字段参数，用匹配搜索，不太清楚全名的，最后加一道模糊搜索，那样效果更好</p> <h4 id="效果展示">效果展示</h4> <p>在浏览器地址栏中输入</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>api<span class="token operator">/</span>tooling<span class="token operator">/</span>?product__PN<span class="token operator">=</span><span class="token number">84977177</span><span class="token operator">&amp;</span>search<span class="token operator">=</span>吹塑
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者，在调试界面，点击<code>Filters</code></p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650410130759.png" alt="1650410130759"></p> <h4 id="小结-2">小结</h4> <p>结合匹配和模糊搜索，就可以快速找到您期望的内容，不过这里还有一点没将，就是如何进行不等式搜索，比如时间大于2022年1月份的？这个后续用到的时候再进行讲解</p> <h3 id="接口测试">接口测试</h3> <p>接口测试还是用<code>postman</code>进行测试，至于这个软件如何使用，请见另外一篇教程。</p> <h4 id="用户登入">用户登入</h4> <p>首先，进行用户登入，然后获取对应的<code>token</code>值，就是下面的<code>access</code></p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650411832852.png" alt="1650411832852"></p> <h4 id="指定token">指定token</h4> <p>如果有些接口有权限控制，那使用<code>api</code>请求的时候，都必须要带上刚才得到的<code>token</code>才可以正常访问，现在我们就来看下如何配置<code>token</code></p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650412030507.png" alt="1650412030507"></p> <ol><li>点击需要配置的接口</li> <li>进入Authorization</li> <li><code>Type</code>类型选择<code>Bearer Token</code></li> <li>将刚才的<code>Access</code>结果添加进去</li></ol> <blockquote><p>注意：这里的token时间是有效期的，具体时间在<code>django</code>的配置文件中</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>SIMPLE_JWT <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token comment"># 'ACCESS_TOKEN_LIFETIME': timedelta(days=1),</span>
 <span class="token string">'ACCESS_TOKEN_LIFETIME'</span><span class="token punctuation">:</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'REFRESH_TOKEN_LIFETIME'</span><span class="token punctuation">:</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></blockquote> <p>好了，一个最简单的<code>get</code>接口配置完成了, 可以正常返回数据了。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650412343222.png" alt="1650412343222"></p> <h4 id="单独模型测试">单独模型测试</h4> <p>对单独模型进行测试，主要测试一个功能模块的增删改查功能，检验功能的同时，也便于后续的调试</p> <p>上一小节中，我们已经实现了对项目模块的<code>get</code>请求测试，下面我们看下相对复杂的接口，比如<code>post</code>, 需要带一些<code>body</code>参数的</p> <h5 id="post请求"><code>POST</code>请求</h5> <p>在测试<code>post</code>接口之前，我们先来了解下2个基本知识点：</p> <ul><li><code>null</code>和<code>blank</code>有什么区别</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>prg_manager <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Profile<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span> related_name<span class="token operator">=</span><span class="token string">'project'</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;项目经理&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目经理&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>仔细看上面代码，有2个参数，<code>null</code>和<code>blank</code>， 怎么感觉两者差不多呢，时间上还是有区别的。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>null<span class="token operator">=</span><span class="token boolean">True</span>	<span class="token comment"># 针对的是数据库，运行这个字段的内容为空</span>
blank<span class="token operator">=</span><span class="token boolean">True</span>	<span class="token comment"># 针对表单的，如果设置为False, 则在提交表单的时候，必须带有对应的参数</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>如何给<code>DateField</code>添加默认值</p> <p><code>DateField</code>这个字段不能为空，但可以按如下给它设置一个默认值 = 今天</p></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>sop <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>default<span class="token operator">=</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;量产时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;客户开始量产时间，这个时候项目必须得移交&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 这个设置好像会报警</span>

sop <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span>default<span class="token operator">=</span>timezone<span class="token punctuation">.</span>now<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;量产时间&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;客户开始量产时间，这个时候项目必须得移交&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 根据报警提示，改成这个就好了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>了解了上述2个知识点后，我们在前期开发的时候，为了方便测试，我们可以把字段尽可能设置成带有默认值的，且<code>blank=True</code></p> <p>好了，脑补这么多后，我们一起来看下效果吧</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650496898675.png" alt="1650496898675"></p> <h5 id="put-请求"><code>PUT</code> 请求</h5> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650497387827.png" alt="1650497387827"></p> <h5 id="delete-请求"><code>DELETE</code> 请求</h5> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650497596371.png" alt="1650497596371"></p> <h4 id="功能模块测试">功能模块测试</h4> <p>所谓功能模块，就是除了增删改查外，根据特定的使用场景进行测试，比如过滤功能，统计功能，我们这里就简单举个例子吧。</p> <p>如下图片，就是在众多工检模中，过滤出所需要的那一条数据，可以多个参数进行组合使用</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650498477082.png" alt="1650498477082"></p> <h3 id="问题清单">问题清单</h3> <h4 id="问题描述">问题描述</h4> <p>一个模型中貌似不能出现2个外键，不然就会报如下错误</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># manager = models.ForeignKey(Profile, default=1, on_delete=models.CASCADE, related_name='project', verbose_name=&quot;项目经理&quot;, help_text=&quot;项目经理&quot;)  # 增加这句话后，就报错</span>
team <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span>to<span class="token operator">=</span>Profile<span class="token punctuation">,</span> related_name<span class="token operator">=</span><span class="token string">'project_team'</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&quot;项目团队&quot;</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span><span class="token string">&quot;项目团队&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>django<span class="token punctuation">.</span>db<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>IntegrityError<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">1452</span><span class="token punctuation">,</span> 'Cannot add <span class="token keyword">or</span> update a child row<span class="token punctuation">:</span> a foreign key constraint fails <span class="token punctuation">(</span>`deep<span class="token operator">-</span>diary`<span class="token punctuation">.</span>`<span class="token comment">#sql-14d8_127`, CONSTRAINT `project_project_manager_id_</span>
3cfb32a0_fk_user_info_profile_id` FOREIGN KEY <span class="token punctuation">(</span>`manager_id`<span class="token punctuation">)</span> REFERENCES `user_info_profile` <span class="token punctuation">(</span>`<span class="token builtin">id</span>`<span class="token punctuation">)</span><span class="token punctuation">)</span>'<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="措施">措施</h4> <p>指定<code>null</code>还有<code>blank</code> 后，貌似就可以了</p> <p>同时，再设置中，也可以增加如下配置</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>DATABASES <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'OPTIONS'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;init_command&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;SET foreign_key_checks = 0;&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>但现在还不确定因为哪种方法，最终不报错，后续再慢慢探索吧</p></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/14/2022, 1:17:07 PM</span></div></footer> <!----> <!----></main> <!----> <div class="comments-wrapper" data-v-4698c43e><!----></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><!----><div></div><!----><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://music.163.com/song/media/outer/url?id=316756.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://p2.music.126.net/qOOTIykbSLw9RHB0vI83GA==/737772302281958.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://p2.music.126.net/qOOTIykbSLw9RHB0vI83GA==/737772302281958.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>大城小事</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>杨千嬅</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----></div></div>
    <script src="/assets/js/app.06d47b9d.js" defer></script><script src="/assets/js/4.ddcf94e0.js" defer></script><script src="/assets/js/1.dee964bb.js" defer></script><script src="/assets/js/72.d8fe63a7.js" defer></script><script src="/assets/js/10.51e38269.js" defer></script>
  </body>
</html>
