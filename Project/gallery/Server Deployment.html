<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>服务器部署 | Deep Diary</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <script charset="utf-8" src="/js/custom.js"></script>
    <meta name="description" content="基于深度学习，专注于旅游，记忆追溯相关的开发">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification">
    <meta name="keywords" content="深记,deep-diary,自建博客,葛维冬，深度学习，记忆追溯">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="robots" content="all">
    <meta name="author" content="deep-diary">
    
    <link rel="preload" href="/assets/css/0.styles.bfd62ff8.css" as="style"><link rel="preload" href="/assets/js/app.6f3ddf89.js" as="script"><link rel="preload" href="/assets/js/4.ddcf94e0.js" as="script"><link rel="preload" href="/assets/js/1.dee964bb.js" as="script"><link rel="preload" href="/assets/js/47.75781b4a.js" as="script"><link rel="preload" href="/assets/js/10.51e38269.js" as="script"><link rel="prefetch" href="/assets/js/100.a4b4f583.js"><link rel="prefetch" href="/assets/js/101.83bbd36c.js"><link rel="prefetch" href="/assets/js/102.c735e003.js"><link rel="prefetch" href="/assets/js/103.3ba966a0.js"><link rel="prefetch" href="/assets/js/104.22fbc95b.js"><link rel="prefetch" href="/assets/js/105.f1f25487.js"><link rel="prefetch" href="/assets/js/106.cbe1ffeb.js"><link rel="prefetch" href="/assets/js/107.98655dd1.js"><link rel="prefetch" href="/assets/js/108.cbf4d5a3.js"><link rel="prefetch" href="/assets/js/109.7044cb04.js"><link rel="prefetch" href="/assets/js/11.dad0ec75.js"><link rel="prefetch" href="/assets/js/110.190693b6.js"><link rel="prefetch" href="/assets/js/111.2e1aaafa.js"><link rel="prefetch" href="/assets/js/112.02dca3b5.js"><link rel="prefetch" href="/assets/js/113.d0b5652f.js"><link rel="prefetch" href="/assets/js/114.26cfec3f.js"><link rel="prefetch" href="/assets/js/115.3afd3fa7.js"><link rel="prefetch" href="/assets/js/116.1c96cca3.js"><link rel="prefetch" href="/assets/js/117.91940e69.js"><link rel="prefetch" href="/assets/js/118.ad218067.js"><link rel="prefetch" href="/assets/js/119.5faa50c6.js"><link rel="prefetch" href="/assets/js/12.dac87fca.js"><link rel="prefetch" href="/assets/js/13.d9355def.js"><link rel="prefetch" href="/assets/js/14.11c18bbb.js"><link rel="prefetch" href="/assets/js/15.3c0fabce.js"><link rel="prefetch" href="/assets/js/16.8f1d7fb5.js"><link rel="prefetch" href="/assets/js/17.ab7555cb.js"><link rel="prefetch" href="/assets/js/18.e2ac1044.js"><link rel="prefetch" href="/assets/js/19.eccade41.js"><link rel="prefetch" href="/assets/js/20.edb23bb0.js"><link rel="prefetch" href="/assets/js/21.9ea1cb9f.js"><link rel="prefetch" href="/assets/js/22.f8f39f91.js"><link rel="prefetch" href="/assets/js/23.67e7076a.js"><link rel="prefetch" href="/assets/js/24.306b0965.js"><link rel="prefetch" href="/assets/js/25.9b8f2f74.js"><link rel="prefetch" href="/assets/js/26.dc81b064.js"><link rel="prefetch" href="/assets/js/27.5000ee31.js"><link rel="prefetch" href="/assets/js/28.84e8eecc.js"><link rel="prefetch" href="/assets/js/29.2d68138d.js"><link rel="prefetch" href="/assets/js/30.dadde165.js"><link rel="prefetch" href="/assets/js/31.58e721b4.js"><link rel="prefetch" href="/assets/js/32.12d092d0.js"><link rel="prefetch" href="/assets/js/33.46480dbf.js"><link rel="prefetch" href="/assets/js/34.67ab1f72.js"><link rel="prefetch" href="/assets/js/35.13c53d85.js"><link rel="prefetch" href="/assets/js/36.5724da60.js"><link rel="prefetch" href="/assets/js/37.d19eefbd.js"><link rel="prefetch" href="/assets/js/38.4c070ec9.js"><link rel="prefetch" href="/assets/js/39.7e96cf57.js"><link rel="prefetch" href="/assets/js/40.f543f3fe.js"><link rel="prefetch" href="/assets/js/41.62924e98.js"><link rel="prefetch" href="/assets/js/42.3825fc8e.js"><link rel="prefetch" href="/assets/js/43.9bfd6f97.js"><link rel="prefetch" href="/assets/js/44.0b6fe679.js"><link rel="prefetch" href="/assets/js/45.11e72e95.js"><link rel="prefetch" href="/assets/js/46.d15a0e3b.js"><link rel="prefetch" href="/assets/js/48.b8692df7.js"><link rel="prefetch" href="/assets/js/49.a3e55e91.js"><link rel="prefetch" href="/assets/js/5.58e443fd.js"><link rel="prefetch" href="/assets/js/50.bb3717ac.js"><link rel="prefetch" href="/assets/js/51.eb5ad581.js"><link rel="prefetch" href="/assets/js/52.24d8e1d9.js"><link rel="prefetch" href="/assets/js/53.7b532fd1.js"><link rel="prefetch" href="/assets/js/54.bff5f909.js"><link rel="prefetch" href="/assets/js/55.1ee63209.js"><link rel="prefetch" href="/assets/js/56.8395ab6b.js"><link rel="prefetch" href="/assets/js/57.22d0ca43.js"><link rel="prefetch" href="/assets/js/58.15dfabda.js"><link rel="prefetch" href="/assets/js/59.315c4cf4.js"><link rel="prefetch" href="/assets/js/6.43391b6b.js"><link rel="prefetch" href="/assets/js/60.6f0776cd.js"><link rel="prefetch" href="/assets/js/61.c071f980.js"><link rel="prefetch" href="/assets/js/62.52b5b138.js"><link rel="prefetch" href="/assets/js/63.9d78f4bd.js"><link rel="prefetch" href="/assets/js/64.845d2da5.js"><link rel="prefetch" href="/assets/js/65.9a735483.js"><link rel="prefetch" href="/assets/js/66.8342f5a1.js"><link rel="prefetch" href="/assets/js/67.7ff4bb61.js"><link rel="prefetch" href="/assets/js/68.af9f712a.js"><link rel="prefetch" href="/assets/js/69.1b44873f.js"><link rel="prefetch" href="/assets/js/7.706f533b.js"><link rel="prefetch" href="/assets/js/70.97d82a51.js"><link rel="prefetch" href="/assets/js/71.f03cb070.js"><link rel="prefetch" href="/assets/js/72.ca683286.js"><link rel="prefetch" href="/assets/js/73.b759d860.js"><link rel="prefetch" href="/assets/js/74.89f510ab.js"><link rel="prefetch" href="/assets/js/75.fde1942f.js"><link rel="prefetch" href="/assets/js/76.39375cec.js"><link rel="prefetch" href="/assets/js/77.3a20de97.js"><link rel="prefetch" href="/assets/js/78.e1659758.js"><link rel="prefetch" href="/assets/js/79.70bd6520.js"><link rel="prefetch" href="/assets/js/8.5e0abf00.js"><link rel="prefetch" href="/assets/js/80.c7f76561.js"><link rel="prefetch" href="/assets/js/81.4ad53bb8.js"><link rel="prefetch" href="/assets/js/82.20618376.js"><link rel="prefetch" href="/assets/js/83.7b7e5114.js"><link rel="prefetch" href="/assets/js/84.0a6aec4a.js"><link rel="prefetch" href="/assets/js/85.43c66608.js"><link rel="prefetch" href="/assets/js/86.f2222e58.js"><link rel="prefetch" href="/assets/js/87.e923fa33.js"><link rel="prefetch" href="/assets/js/88.48022ddb.js"><link rel="prefetch" href="/assets/js/89.bfff836f.js"><link rel="prefetch" href="/assets/js/9.2d9184d6.js"><link rel="prefetch" href="/assets/js/90.c8a04460.js"><link rel="prefetch" href="/assets/js/91.ba7676e6.js"><link rel="prefetch" href="/assets/js/92.b7801b6b.js"><link rel="prefetch" href="/assets/js/93.e7a14447.js"><link rel="prefetch" href="/assets/js/94.5756eda3.js"><link rel="prefetch" href="/assets/js/95.33c70a61.js"><link rel="prefetch" href="/assets/js/96.49bacfb9.js"><link rel="prefetch" href="/assets/js/97.961a340e.js"><link rel="prefetch" href="/assets/js/98.ea8376c0.js"><link rel="prefetch" href="/assets/js/99.a96e73be.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.e51760b9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bfd62ff8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-4698c43e><div data-v-4698c43e><div id="loader-wrapper" class="loading-wrapper" data-v-1c4f0192 data-v-4698c43e data-v-4698c43e><div class="loader-main" data-v-1c4f0192><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-6cbeab0a data-v-4698c43e data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>Deep Diary</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>Blue</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-4698c43e><header class="navbar" data-v-4698c43e><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Deep Diary</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/categories/deep learning/" class="nav-link"><i class="iconfont undefined"></i>
  deep learning
</a></li><li class="dropdown-item"><!----> <a href="/categories/ROS/" class="nav-link"><i class="iconfont undefined"></i>
  ROS
</a></li><li class="dropdown-item"><!----> <a href="/categories/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li><li class="dropdown-item"><!----> <a href="/categories/ros2/" class="nav-link"><i class="iconfont undefined"></i>
  ros2
</a></li><li class="dropdown-item"><!----> <a href="/categories/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li><li class="dropdown-item"><!----> <a href="/categories/Develop/" class="nav-link"><i class="iconfont undefined"></i>
  Develop
</a></li><li class="dropdown-item"><!----> <a href="/categories/guide/" class="nav-link"><i class="iconfont undefined"></i>
  guide
</a></li><li class="dropdown-item"><!----> <a href="/categories/Gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/参考资料/" class="nav-link"><i class="iconfont undefined"></i>
  参考资料
</a></li><li class="dropdown-item"><!----> <a href="/categories/conference/" class="nav-link"><i class="iconfont undefined"></i>
  conference
</a></li><li class="dropdown-item"><!----> <a href="/categories/project/" class="nav-link"><i class="iconfont undefined"></i>
  project
</a></li><li class="dropdown-item"><!----> <a href="/categories/blog/" class="nav-link"><i class="iconfont undefined"></i>
  blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/vuepress/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress
</a></li><li class="dropdown-item"><!----> <a href="/categories/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/categories/WEB/" class="nav-link"><i class="iconfont undefined"></i>
  WEB
</a></li><li class="dropdown-item"><!----> <a href="/categories/Synology/" class="nav-link"><i class="iconfont undefined"></i>
  Synology
</a></li><li class="dropdown-item"><!----> <a href="/categories/voice/" class="nav-link"><i class="iconfont undefined"></i>
  voice
</a></li><li class="dropdown-item"><!----> <a href="/categories/PM/" class="nav-link"><i class="iconfont undefined"></i>
  PM
</a></li><li class="dropdown-item"><!----> <a href="/categories/django/" class="nav-link"><i class="iconfont undefined"></i>
  django
</a></li><li class="dropdown-item"><!----> <a href="/categories/database/" class="nav-link"><i class="iconfont undefined"></i>
  database
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      Guide
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link"><i class="iconfont undefined"></i>
  Guide
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Project
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/management/" class="nav-link"><i class="iconfont undefined"></i>
  Management
</a></li><li class="dropdown-item"><!----> <a href="/project/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/project/blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Embedded
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Deep Learning
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Deep-Learning/" class="nav-link"><i class="iconfont undefined"></i>
  Deep Learning
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Web
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/Backend/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/mysql/" class="nav-link"><i class="iconfont undefined"></i>
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/web/backend/nginx/" class="nav-link"><i class="iconfont undefined"></i>
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/web/frondend/vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/" class="nav-link"><i class="iconfont undefined"></i>
  Database
</a></li><li class="dropdown-item"><!----> <a href="/web/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Software
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-date"></i>
      Algorithm
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-4698c43e></div> <aside class="sidebar" data-v-4698c43e><div class="personal-info-wrapper" data-v-6c8ffc9c><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-6c8ffc9c> <h3 class="name" data-v-6c8ffc9c>
    Blue
  </h3> <div class="num" data-v-6c8ffc9c><div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>79</h3> <h6 data-v-6c8ffc9c>文章</h6></div> <div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>104</h3> <h6 data-v-6c8ffc9c>标签</h6></div></div> <hr data-v-6c8ffc9c></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/categories/deep learning/" class="nav-link"><i class="iconfont undefined"></i>
  deep learning
</a></li><li class="dropdown-item"><!----> <a href="/categories/ROS/" class="nav-link"><i class="iconfont undefined"></i>
  ROS
</a></li><li class="dropdown-item"><!----> <a href="/categories/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li><li class="dropdown-item"><!----> <a href="/categories/ros2/" class="nav-link"><i class="iconfont undefined"></i>
  ros2
</a></li><li class="dropdown-item"><!----> <a href="/categories/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li><li class="dropdown-item"><!----> <a href="/categories/Develop/" class="nav-link"><i class="iconfont undefined"></i>
  Develop
</a></li><li class="dropdown-item"><!----> <a href="/categories/guide/" class="nav-link"><i class="iconfont undefined"></i>
  guide
</a></li><li class="dropdown-item"><!----> <a href="/categories/Gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/参考资料/" class="nav-link"><i class="iconfont undefined"></i>
  参考资料
</a></li><li class="dropdown-item"><!----> <a href="/categories/conference/" class="nav-link"><i class="iconfont undefined"></i>
  conference
</a></li><li class="dropdown-item"><!----> <a href="/categories/project/" class="nav-link"><i class="iconfont undefined"></i>
  project
</a></li><li class="dropdown-item"><!----> <a href="/categories/blog/" class="nav-link"><i class="iconfont undefined"></i>
  blog
</a></li><li class="dropdown-item"><!----> <a href="/categories/vuepress/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress
</a></li><li class="dropdown-item"><!----> <a href="/categories/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  gallery
</a></li><li class="dropdown-item"><!----> <a href="/categories/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/categories/WEB/" class="nav-link"><i class="iconfont undefined"></i>
  WEB
</a></li><li class="dropdown-item"><!----> <a href="/categories/Synology/" class="nav-link"><i class="iconfont undefined"></i>
  Synology
</a></li><li class="dropdown-item"><!----> <a href="/categories/voice/" class="nav-link"><i class="iconfont undefined"></i>
  voice
</a></li><li class="dropdown-item"><!----> <a href="/categories/PM/" class="nav-link"><i class="iconfont undefined"></i>
  PM
</a></li><li class="dropdown-item"><!----> <a href="/categories/django/" class="nav-link"><i class="iconfont undefined"></i>
  django
</a></li><li class="dropdown-item"><!----> <a href="/categories/database/" class="nav-link"><i class="iconfont undefined"></i>
  database
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      Guide
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link"><i class="iconfont undefined"></i>
  Guide
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Project
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/management/" class="nav-link"><i class="iconfont undefined"></i>
  Management
</a></li><li class="dropdown-item"><!----> <a href="/project/gallery/" class="nav-link"><i class="iconfont undefined"></i>
  Gallery
</a></li><li class="dropdown-item"><!----> <a href="/project/blog/" class="nav-link"><i class="iconfont undefined"></i>
  Blog
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Embedded
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Embedded/" class="nav-link"><i class="iconfont undefined"></i>
  Embedded
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Deep Learning
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Deep-Learning/" class="nav-link"><i class="iconfont undefined"></i>
  Deep Learning
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Web
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/Backend/Django/" class="nav-link"><i class="iconfont undefined"></i>
  Django
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/mysql/" class="nav-link"><i class="iconfont undefined"></i>
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/web/backend/nginx/" class="nav-link"><i class="iconfont undefined"></i>
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/web/frondend/vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/web/Database/" class="nav-link"><i class="iconfont undefined"></i>
  Database
</a></li><li class="dropdown-item"><!----> <a href="/web/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Software
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Software/" class="nav-link"><i class="iconfont undefined"></i>
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-date"></i>
      Algorithm
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  Algorithm
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Gallery</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Project/gallery/1. user login backend.html" class="sidebar-link">用户登入后端</a></li><li><a href="/Project/gallery/2. user login frontend.html" class="sidebar-link">用户登入前端</a></li><li><a href="/Project/gallery/3. gallery backend.html" class="sidebar-link">相册模块后台</a></li><li><a href="/Project/gallery/4. gallery frontend.html" class="sidebar-link">相册模块前台</a></li><li><a href="/Project/gallery/Amap.html" class="sidebar-link">高德地图</a></li><li><a href="/Project/gallery/Asynchronous tasks_celery.html" class="sidebar-link">Django 处理异步任务</a></li><li><a href="/Project/gallery/CND Improve the speed of website access.html" class="sidebar-link">CDN 提高网站访问速度</a></li><li><a href="/Project/gallery/Development environment setup.html" class="sidebar-link">搭建开发环境</a></li><li><a href="/Project/gallery/GraphNavigator.html" class="sidebar-link">GraphNavigator</a></li><li><a href="/Project/gallery/" aria-current="page" class="sidebar-link">Introduction of Gallery Project</a></li><li><a href="/Project/gallery/Server Deployment.html" class="active sidebar-link">服务器部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Project/gallery/Server Deployment.html#安装数据库" class="sidebar-link">安装数据库</a></li><li class="sidebar-sub-header"><a href="/Project/gallery/Server Deployment.html#前端代码打包" class="sidebar-link">前端代码打包</a></li><li class="sidebar-sub-header"><a href="/Project/gallery/Server Deployment.html#后端代码部署" class="sidebar-link">后端代码部署</a></li><li class="sidebar-sub-header"><a href="/Project/gallery/Server Deployment.html#icp备案" class="sidebar-link">ICP备案</a></li><li class="sidebar-sub-header"><a href="/Project/gallery/Server Deployment.html#大文件上传" class="sidebar-link">大文件上传</a></li><li class="sidebar-sub-header"><a href="/Project/gallery/Server Deployment.html#oss对象存储" class="sidebar-link">oss对象存储</a></li></ul></li><li><a href="/Project/gallery/build the face group.html" class="sidebar-link">Build the Face Group</a></li><li><a href="/Project/gallery/face recognition.html" class="sidebar-link">人脸模块后台</a></li><li><a href="/Project/gallery/fetch basic info from image.html" class="sidebar-link">fetch the basic info from image</a></li><li><a href="/Project/gallery/fetch categorizers from image.html" class="sidebar-link">fetch categorizers from the image</a></li><li><a href="/Project/gallery/fetch colors from image.html" class="sidebar-link">fetch colors from the image</a></li><li><a href="/Project/gallery/fetch gps.html" class="sidebar-link">fetch gps</a></li><li><a href="/Project/gallery/fetch tags from image.html" class="sidebar-link">fetch tags from the image</a></li><li><a href="/Project/gallery/fetch wechat.html" class="sidebar-link">fetch wechat</a></li><li><a href="/Project/gallery/git version control.html" class="sidebar-link">git version control</a></li><li><a href="/Project/gallery/graph database_Neo4j.html" class="sidebar-link">图数据库neo4j</a></li><li><a href="/Project/gallery/https.html" class="sidebar-link">update http to https</a></li><li><a href="/Project/gallery/infinite scroll.html" class="sidebar-link">Infinite Scroll</a></li><li><a href="/Project/gallery/object identification.html" class="sidebar-link">目标后台</a></li><li><a href="/Project/gallery/oss storage.html" class="sidebar-link">Django 实现云存储</a></li><li><a href="/Project/gallery/quick search.html" class="sidebar-link">quick search</a></li><li><a href="/Project/gallery/setting of backend.html" class="sidebar-link">setting of backend</a></li><li><a href="/Project/gallery/synology.html" class="sidebar-link">Synology</a></li><li><a href="/Project/gallery/trademark registration.html" class="sidebar-link">商标注册</a></li><li><a href="/Project/gallery/upload the image.html" class="sidebar-link">upload the image</a></li><li><a href="/Project/gallery/voice.html" class="sidebar-link">voice</a></li><li><a href="/Project/gallery/vue-awesome-swiper.html" class="sidebar-link">vue-awesome-swiper</a></li><li><a href="/Project/gallery/web3.html" class="sidebar-link">web3</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-6cbeab0a data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>服务器部署</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>Blue</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2023
        </a></span></div></div> <div data-v-4698c43e><main class="page"><!----> <div class="page-title" style="display:none;"><h1>服务器部署</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>Blue</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2022-08-13</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      部署
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p class="custom-block-title">说明</p> <p>​	本文主要介绍如何将开发好的网站，部署到服务器</p> <p><a href="www.deep-diary.com">点击免费观看教学视频</a></p></div> <h1 id="服务器部署">服务器部署</h1> <h2 id="安装数据库">安装数据库</h2> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/2527092840af4e15a24b0b2a8bf71776.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>通过阿里云进入服务器</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1e7ef3975db048ffab5ebd3a121a04e0.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>服务器命令界面</p> <h3 id="更新ubantu相关包">更新Ubantu相关包</h3> <p>登陆到Ubuntu的服务器</p> <p>更新源：sudo apt-get update</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/2112be3cd76b4f098fc78090b15858ae.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>源已经更新完毕</p> <p>安装源：sudo apt-get upgrade</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/41712ac4c7374418987e45a77108d7b5.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>选中Y进行安装升级</p> <h3 id="第二步安装的mysql服务器">第二步安装的MySQL服务器</h3> <p>执行：sudo apt-get install mysql-server</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/64e2615a292c43e789145b3489ab7f5a.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>安装mysql服务器</p> <p>执行：sudo apt-get install mysql-client</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/badbd086c7134901b7fa08248f71cc1e.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>安装mysql客户端</p> <p>执行：sudo apt install libmysqlclient-dev</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/d7e6913e7f0f44769899fb3adfb239be.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>安装mysql相关驱动</p> <p>安装成功后可以通过下面的命令测试是否安装成功：</p> <p>sudo netstat -tap | grep mysql</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/4f60280d929a46de95c185be5bb37474.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>出现类似字符，表明安装成功了</p> <p><strong>Linux netstat</strong> 命令用于显示网络状态。</p> <p>利用 netstat 指令可让你得知整个 Linux 系统的网络情况。</p> <ul><li>-t或--tcp 显示TCP传输协议的连线状况。</li> <li>-a或--all 显示所有连线中的Socket。</li> <li>-p或--programs 显示正在使用Socket的程序识别码和程序名称。</li></ul> <p><strong>Linux grep</strong> 命令用于查找文件里符合条件的字符串。</p> <p>grep 指令用于查找内容包含指定的范本样式的文件，如果发现某文件的内容符合所指定的范本样式，预设 grep 指令会把含有范本样式的那一列显示出来。若不指定任何文件名称，或是所给予的文件名为 <strong>-</strong>，则 grep 指令会从标准输入设备读取数据。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>grep [-abcEFGhHilLnqrsvVwxy][-A&lt;显示行数&gt;][-B&lt;显示列数&gt;][-C&lt;显示列数&gt;][-d&lt;进行动作&gt;][-e&lt;范本样式&gt;][-f&lt;范本文件&gt;][--help][范本样式][文件或目录...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="第三步更新数据库密码并登入">第三步更新数据库密码并登入</h3> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/77baff1df0fc4d719e0b967271e14c29.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>查看mysql 默认用户名，密码</p> <p>最最重要的是：用户名默认的不是root，而是debian-sys-maint，如上图所示</p> <p><strong>先测试本地登入</strong></p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/76749ca06bd341c6a705bed8e809e554.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>本地登入成功</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/d97c18dcd1034361b418446b0737a651.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>更新密码并重新登入</p> <p><strong>启动mysql数据库</strong></p> <p>sudo /etc/init.d/mysql start</p> <p><strong>重启</strong></p> <p>sudo /etc/init.d/mysql restart</p> <p><strong>关闭</strong></p> <p>sudo /etc/init.d/mysql stop</p> <p><strong>再测试远程登入</strong></p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/6526eff5884b4f7583aeab0498fbaf3c.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>创建新用户并授予远程访问的权限</p> <p>应先创建新用户</p> <p>create user 'admin'@'%' identified by 'password';</p> <p>执行授权</p> <p>GRANT ALL PRIVILEGES ON <em>.</em> TO 'admin'@'%';</p> <p>刷新</p> <p>flush privileges;</p> <p>授权远程</p> <p>ALTER USER 'admin'@'%' IDENTIFIED WITH mysql_native_password BY 'password';</p> <p>刷新</p> <p>flush privileges;</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/9b63e45df88c4c409b4a3781ff78271a.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>远程登入步骤</p> <ol><li>编辑配置文件，取消把绑定ip从127.0.0.1 改为0.0.0.0</li> <li>重启mysql服务</li> <li>在远程通过命令行登入</li></ol> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/83e85a5b8e5f4e20a903a8f5b1b424e3.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>更改绑定ip</p> <p><strong>使用Navicat远程登入</strong></p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/c2ad2f6d813144559be377cd71cd1bb1.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <p>使用Navicat 连接数据库</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/bd9c54172df645568cdee478502202b7.png" alt="Django搭建深度日记：服务器数据库部署-深度日记官方网站"></p> <h2 id="前端代码打包">前端代码打包</h2> <p>build the project</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="some-issues">some issues</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> error  <span class="token keyword">in</span> ./src/views/register/index.vue?vue<span class="token operator">&amp;</span><span class="token assign-left variable">type</span><span class="token operator">=</span>style<span class="token operator">&amp;</span><span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span>5bcc9eb4<span class="token operator">&amp;</span><span class="token assign-left variable">lang</span><span class="token operator">=</span>scss<span class="token operator">&amp;</span><span class="token assign-left variable">scoped</span><span class="token operator">=</span>true<span class="token operator">&amp;</span>

Error: Cannot <span class="token function">find</span> module <span class="token string">'imagemin-gifsicle'</span>
Require stack:
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>image-webpack-loader<span class="token punctuation">\</span>index.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>loader-runner<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>loadLoader.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>loader-runner<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>LoaderRunner.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>webpack<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>NormalModule.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>webpack<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>NormalModuleFactory.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>webpack<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>Compiler.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>webpack<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>webpack.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>vue.config.js
- D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Frontend<span class="token punctuation">\</span>package.json


 @ ./src/views/register/index.vue?vue<span class="token operator">&amp;</span><span class="token assign-left variable">type</span><span class="token operator">=</span>style<span class="token operator">&amp;</span><span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span>5bcc9eb4<span class="token operator">&amp;</span><span class="token assign-left variable">lang</span><span class="token operator">=</span>scss<span class="token operator">&amp;</span><span class="token assign-left variable">scoped</span><span class="token operator">=</span>true<span class="token operator">&amp;</span> <span class="token number">1</span>:0-548 <span class="token number">1</span>:0-548
 @ ./src/views/register/index.vue
 @ ./src/router/index.js
 @ ./src/main.js
 @ multi ./src/main.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="solutions">solutions</h3> <p>1、在packgae.json 加上 “imagemin-gifsicle” ：&quot;^2.0.0&quot;,</p> <p>2、再次运行时报错信息error:cannot find module “gifsicle” 这时就要去node_moudules里删除 image-webpack-loader</p> <p>3、再去更新下载 cnpm install --save-dev image-webpack-loader</p> <p>4、重新运行打包命令即可
————————————————
版权声明：本文为CSDN博主「玛卡巴卡阿卡哇」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/qq_41147046/article/details/123152703</p> <h2 id="后端代码部署">后端代码部署</h2> <h3 id="源码库打包">源码库打包</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>pip freeze <span class="token operator">&gt;</span> requirements.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/73be118395f349de96bb5d3682bd419e.png" alt="Django搭建深度日记：将项目部署到服务器-深度日记官方网站"></p> <p>在虚拟环境中，打包相关依赖库，便于直接在服务器进行安装</p> <h3 id="本地测试依赖库">本地测试依赖库</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pip <span class="token function">install</span> virtualenv

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="python-virtualenv安装报错-已解决">python virtualenv安装报错，已解决</h4> <blockquote><p><a href="https://blog.csdn.net/Coder_Bao/article/details/113380959" target="_blank" rel="noopener noreferrer"> python virtualenv安装报错，已解决_Dennis、的博客-CSDN博客_virtualenv报错<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>virtualenv --python<span class="token operator">=</span>python3.8 <span class="token function">env</span>
virtualenv <span class="token function">env</span>  <span class="token comment"># 或者直接创建</span>

<span class="token comment"># 刚创建好的环境，只有很少一部分包</span>
<span class="token punctuation">(</span>env<span class="token punctuation">)</span> D:<span class="token punctuation">\</span>BlueDoc<span class="token punctuation">\</span>DeepDiary<span class="token punctuation">\</span>Backend<span class="token punctuation">\</span>env<span class="token punctuation">\</span>Scripts<span class="token operator">&gt;</span>pip list
Package    Version
---------- -------
pip        <span class="token number">22.1</span>.2
setuptools <span class="token number">62.5</span>.0
wheel      <span class="token number">0.37</span>.1

<span class="token punctuation">[</span>notice<span class="token punctuation">]</span> A new release of pip available: <span class="token number">22.1</span>.2 -<span class="token operator">&gt;</span> <span class="token number">22.2</span>.2
<span class="token punctuation">[</span>notice<span class="token punctuation">]</span> To update, run: python.exe -m pip <span class="token function">install</span> --upgrade pip   <span class="token comment"># 根据提示，执行此命令</span>

<span class="token comment"># 进入env 环境目录后，激活脚本</span>
./Scripts/activate.bat    <span class="token comment"># 激活虚拟环境</span>
<span class="token comment"># ./Scripts/deactivate.bat    # 退出虚拟环境</span>

<span class="token comment"># Windows中使用virtualenvwrapper-win，Linux中直接使用virtualenvwrapper</span>
pip <span class="token function">install</span> virtualenvwrapper-win
<span class="token comment"># 然后使用workon查看是否安装成功</span>
workon


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="安装torch">安装torch</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pip3 install torch torchvision torchaudio <span class="token operator">-</span><span class="token operator">-</span>extra<span class="token operator">-</span>index<span class="token operator">-</span>url https<span class="token punctuation">:</span><span class="token operator">//</span>download<span class="token punctuation">.</span>pytorch<span class="token punctuation">.</span>org<span class="token operator">/</span>whl<span class="token operator">/</span>cu113  <span class="token comment"># 本地安装torch</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="服务器端安装相关的环境库">服务器端安装相关的环境库</h3> <p>当直接安装<code>requirements.txt</code>，会报如下的一些错误</p> <h4 id="install-virtualenv">install virtualenv</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>root@deep-diary:~# sudo apt-get install nginx
root@deep-diary:~# sudo apt-get install python3
root@deep-diary:~# sudo apt-get install python3-pip
root@deep-diary:~# sudo pip3 install virtualenv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>之前开发时虚拟环境用的 python 自带的，为了避免读者的版本不同造成的各类错误，稳妥起见用 virtualenv 库来创建虚拟环境，操作步骤都是差不多的。</p> <p>创建网站目录</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home<span class="token comment"># ls</span>
Backend  Backend_Harry  deep-diary  deep_diary  sites  start.sh  venv  venv_diary<span class="token punctuation">(</span>this is the venv environment<span class="token punctuation">)</span>
<span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home<span class="token comment"># cd /home/Backend</span>
<span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home/Backend<span class="token comment"># </span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>参数说明</strong>：</p> <ul><li>-p 确保目录名称存在，不存在的就建一个。</li></ul> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/9d10851d06a640ed8ace6452f546baa6.png" alt="Django搭建深度日记：将项目部署到服务器-深度日记官方网站"></p> <p>将本地代码直接复制到服务器</p> <p>接下里需要做就是将本地代码复制到服务器，这里推荐一个工具软件WinSCP, 这个软件可以使用多种协议，连接到服务器，对服务器文件进行可视化操作。</p> <p>接着在服务器上生成虚拟环境，在这里用 virtualenv 生成并激活了虚拟环境：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@deep-diary:/home/sites/deep-diary.com<span class="token comment"># virtualenv --python=python3.8 venv_diary</span>
created virtual environment CPython3.8.10.final.0-64 <span class="token keyword">in</span> 840ms
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/<span class="token comment"># cd /home/venv_diary/bin/</span>
<span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home/venv_diary/bin<span class="token comment"># deactivate  # deactivate the venv</span>
root@deep-diary:/home/venv_diary/bin<span class="token comment"># source activate   # activate the venv</span>
<span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home/venv_diary/bin<span class="token comment"># </span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="安装insightface"><strong>安装<code>insightface</code></strong></h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>Before installing the package via pip, first <span class="token function">install</span> the following packages

pip <span class="token function">install</span> -U Cython cmake numpy
and <span class="token keyword">then</span> finally use

pip <span class="token function">install</span> -U insightface
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="安装torch-2">安装torch</h4> <p>这个原因主要来自于window和linux不兼容引起的</p> <h5 id="linux-下查看cuda版本">linux 下查看cuda版本</h5> <blockquote><p><a href="https://blog.csdn.net/hb_learing/article/details/115534219" target="_blank" rel="noopener noreferrer">Linux查看当前Cuda（CUDA Toolkit ）版本_查无此人☞的博客-CSDN博客_linux查看cuda版本命令<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> root@deep-diary:/home/Backend<span class="token comment"># nvcc -V</span>

Command <span class="token string">'nvcc'</span> not found, but can be installed with:

<span class="token function">apt</span> <span class="token function">install</span> nvidia-cuda-toolkit

<span class="token comment"># 如果报错，可以尝试执行 </span>
<span class="token function">apt-get</span> upgrade

<span class="token comment"># 安装成功后，再次执行</span>
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> root@deep-diary:/home/Backend<span class="token comment"># nvcc -V</span>
nvcc: NVIDIA <span class="token punctuation">(</span>R<span class="token punctuation">)</span> Cuda compiler driver
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2005</span>-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release <span class="token number">10.1</span>, V10.1.243  <span class="token comment"># 可以看到这个linux系统的cuda是V10.1 版本的</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="安装pytorch">安装pytorch</h5> <blockquote><p><a href="https://blog.csdn.net/weixin_43975982/article/details/105165640" target="_blank" rel="noopener noreferrer">Linux下安装pytorch_音序的博客-CSDN博客_linux安装pytorch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>这里一定需要选择跟cuda版本匹配的torch</p> <p>官网上会显示所有历史版本，网址链接如下<a href="https://pytorch.org/get-started/previous-versions/" target="_blank" rel="noopener noreferrer">Previous PyTorch Versions | PyTorch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># CUDA 10.1</span>
conda <span class="token function">install</span> <span class="token assign-left variable">pytorch</span><span class="token operator">==</span><span class="token number">1.7</span>.1 <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.8</span>.2 <span class="token assign-left variable">torchaudio</span><span class="token operator">==</span><span class="token number">0.7</span>.2 <span class="token assign-left variable">cudatoolkit</span><span class="token operator">=</span><span class="token number">10.1</span> -c pytorch
pip <span class="token function">install</span> <span class="token assign-left variable">torch</span><span class="token operator">==</span><span class="token number">1.7</span>.1+cu101 <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.8</span>.2+cu101 <span class="token assign-left variable">torchaudio</span><span class="token operator">==</span><span class="token number">0.7</span>.2 -f https://download.pytorch.org/whl/torch_stable.html

pip <span class="token function">install</span> <span class="token assign-left variable">torch</span><span class="token operator">==</span><span class="token number">1.11</span>.0+cpu <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.12</span>.0+cpu <span class="token assign-left variable">torchaudio</span><span class="token operator">==</span><span class="token number">0.11</span>.0 --extra-index-url https://download.pytorch.org/whl/cpu <span class="token comment"># cpu 版本 </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="安装requirements-txt">安装requirements.txt</h4> <h5 id="安装相关依赖库">安装相关依赖库</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pip <span class="token function">install</span> -r requirements.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="click-and-openmim">click and openmim</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ERROR: Cannot <span class="token function">install</span> -r requirements.txt <span class="token punctuation">(</span>line <span class="token number">113</span><span class="token punctuation">)</span>, -r requirements.txt <span class="token punctuation">(</span>line <span class="token number">24</span><span class="token punctuation">)</span>, -r requirements.txt <span class="token punctuation">(</span>line <span class="token number">29</span><span class="token punctuation">)</span>, -r requirements.txt <span class="token punctuation">(</span>line <span class="token number">30</span><span class="token punctuation">)</span>, -r requirements.txt <span class="token punctuation">(</span>line <span class="token number">31</span><span class="token punctuation">)</span>, <span class="token assign-left variable">click</span><span class="token operator">==</span><span class="token number">8.1</span>.3 and <span class="token assign-left variable">openmim</span><span class="token operator">==</span><span class="token number">0.1</span>.5 because these package versions have conflicting dependencies.

The conflict is caused by:
    The user requested <span class="token assign-left variable">click</span><span class="token operator">==</span><span class="token number">8.1</span>.3
    celery <span class="token number">5.2</span>.7 depends on click<span class="token operator">&lt;</span><span class="token number">9.0</span> and <span class="token operator">&gt;=</span><span class="token number">8.0</span>.3
    click-didyoumean <span class="token number">0.3</span>.0 depends on click<span class="token operator">&gt;=</span><span class="token number">7</span>
    click-plugins <span class="token number">1.1</span>.1 depends on click<span class="token operator">&gt;=</span><span class="token number">4.0</span>
    click-repl <span class="token number">0.2</span>.0 depends on click
    model-index <span class="token number">0.1</span>.11 depends on click
    openmim <span class="token number">0.1</span>.5 depends on <span class="token assign-left variable">Click</span><span class="token operator">==</span><span class="token number">7.1</span>.2

To fix this you could try to:
<span class="token number">1</span>. loosen the range of package versions you've specified
<span class="token number">2</span>. remove package versions to allow pip attempt to solve the dependency conflict
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="pywin32">pywin32</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ERROR: No matching distribution found <span class="token keyword">for</span> <span class="token assign-left variable">pywin32</span><span class="token operator">==</span><span class="token number">304</span>

<span class="token comment"># pywin32是一个第三方模块库，主要的作用是方便python开发者快速调用windows API的一个模块库。</span>

<span class="token comment"># 同时pywin32也是绝大部分windows上第三方python模块库的前提，例如wmi，如果没有安装pywin32是无法正常使用wmi这个三方模块库的。</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>absl<span class="token operator">-</span>py<span class="token operator">==</span><span class="token number">0.13</span><span class="token number">.0</span>
addict<span class="token operator">==</span><span class="token number">2.4</span><span class="token number">.0</span>
aiohttp<span class="token operator">==</span><span class="token number">3.8</span><span class="token number">.1</span>
aiosignal<span class="token operator">==</span><span class="token number">1.2</span><span class="token number">.0</span>
albumentations<span class="token operator">==</span><span class="token number">1.1</span><span class="token number">.0</span>
aliyun<span class="token operator">-</span>python<span class="token operator">-</span>sdk<span class="token operator">-</span>core<span class="token operator">==</span><span class="token number">2.13</span><span class="token number">.36</span>
aliyun<span class="token operator">-</span>python<span class="token operator">-</span>sdk<span class="token operator">-</span>kms<span class="token operator">==</span><span class="token number">2.15</span><span class="token number">.0</span>
argon2<span class="token operator">-</span>cffi<span class="token operator">==</span><span class="token number">21.3</span><span class="token number">.0</span>
argon2<span class="token operator">-</span>cffi<span class="token operator">-</span>bindings<span class="token operator">==</span><span class="token number">21.2</span><span class="token number">.0</span>
asgiref<span class="token operator">==</span><span class="token number">3.4</span><span class="token number">.1</span>
asttokens<span class="token operator">==</span><span class="token number">2.0</span><span class="token number">.5</span>
<span class="token keyword">async</span><span class="token operator">-</span>timeout<span class="token operator">==</span><span class="token number">4.0</span><span class="token number">.2</span>
attrs<span class="token operator">==</span><span class="token number">21.4</span><span class="token number">.0</span>
backcall<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.0</span>
backports<span class="token punctuation">.</span>zoneinfo<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.1</span>
base58<span class="token operator">==</span><span class="token number">2.1</span><span class="token number">.1</span>
beautifulsoup4<span class="token operator">==</span><span class="token number">4.11</span><span class="token number">.1</span>
bitarray<span class="token operator">==</span><span class="token number">2.6</span><span class="token number">.0</span>
bleach<span class="token operator">==</span><span class="token number">5.0</span><span class="token number">.0</span>
boltons<span class="token operator">==</span><span class="token number">21.0</span><span class="token number">.0</span>
cchardet<span class="token operator">==</span><span class="token number">2.1</span><span class="token number">.7</span>
certifi<span class="token operator">==</span><span class="token number">2021.10</span><span class="token number">.8</span>
cffi<span class="token operator">==</span><span class="token number">1.15</span><span class="token number">.0</span>
charset<span class="token operator">-</span>normalizer<span class="token operator">==</span><span class="token number">2.0</span><span class="token number">.10</span>
click<span class="token operator">==</span><span class="token number">7.1</span><span class="token number">.2</span>
cmake<span class="token operator">==</span><span class="token number">3.24</span><span class="token number">.1</span>
colorama<span class="token operator">==</span><span class="token number">0.4</span><span class="token number">.4</span>
commonmark<span class="token operator">==</span><span class="token number">0.9</span><span class="token number">.1</span>
coreschema<span class="token operator">==</span><span class="token number">0.0</span><span class="token number">.4</span>
crcmod<span class="token operator">==</span><span class="token number">1.7</span>
cryptography<span class="token operator">==</span><span class="token number">36.0</span><span class="token number">.1</span>
cycler<span class="token operator">==</span><span class="token number">0.11</span><span class="token number">.0</span>
Cython<span class="token operator">==</span><span class="token number">0.29</span><span class="token number">.32</span>
cytoolz<span class="token operator">==</span><span class="token number">0.12</span><span class="token number">.0</span>
debugpy<span class="token operator">==</span><span class="token number">1.6</span><span class="token number">.0</span>
decorator<span class="token operator">==</span><span class="token number">5.1</span><span class="token number">.1</span>
defusedxml<span class="token operator">==</span><span class="token number">0.7</span><span class="token number">.1</span>
Django<span class="token operator">==</span><span class="token number">3.2</span><span class="token number">.9</span>
django<span class="token operator">-</span>allauth<span class="token operator">==</span><span class="token number">0.47</span><span class="token number">.0</span>
django<span class="token operator">-</span>appconf<span class="token operator">==</span><span class="token number">1.0</span><span class="token number">.5</span>
django<span class="token operator">-</span>ckeditor<span class="token operator">==</span><span class="token number">6.2</span><span class="token number">.0</span>
django<span class="token operator">-</span>cors<span class="token operator">-</span>headers<span class="token operator">==</span><span class="token number">3.13</span><span class="token number">.0</span>
django<span class="token operator">-</span>extensions<span class="token operator">==</span><span class="token number">3.1</span><span class="token number">.5</span>
django<span class="token operator">-</span><span class="token builtin">filter</span><span class="token operator">==</span><span class="token number">21.1</span>
django<span class="token operator">-</span>imagekit<span class="token operator">==</span><span class="token number">4.1</span><span class="token number">.0</span>
django<span class="token operator">-</span>js<span class="token operator">-</span>asset<span class="token operator">==</span><span class="token number">1.2</span><span class="token number">.2</span>
django<span class="token operator">-</span>mdeditor<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.20</span>
django<span class="token operator">-</span>model<span class="token operator">-</span>utils<span class="token operator">==</span><span class="token number">4.2</span><span class="token number">.0</span>
django<span class="token operator">-</span>mptt<span class="token operator">==</span><span class="token number">0.13</span><span class="token number">.4</span>
django<span class="token operator">-</span>notifications<span class="token operator">-</span>hq<span class="token operator">==</span><span class="token number">1.6</span><span class="token number">.0</span>
django<span class="token operator">-</span>oss<span class="token operator">-</span>storage<span class="token operator">==</span><span class="token number">1.1</span><span class="token number">.1</span>
django<span class="token operator">-</span>password<span class="token operator">-</span>reset<span class="token operator">==</span><span class="token number">2.0</span>
django<span class="token operator">-</span>taggit<span class="token operator">==</span><span class="token number">2.0</span><span class="token number">.0</span>
djangorestframework<span class="token operator">==</span><span class="token number">3.13</span><span class="token number">.1</span>
djangorestframework<span class="token operator">-</span>jwt<span class="token operator">==</span><span class="token number">1.11</span><span class="token number">.0</span>
djangorestframework<span class="token operator">-</span>simplejwt<span class="token operator">==</span><span class="token number">5.1</span><span class="token number">.0</span>
easydict<span class="token operator">==</span><span class="token number">1.9</span>
entrypoints<span class="token operator">==</span><span class="token number">0.4</span>
eth<span class="token operator">-</span>abi<span class="token operator">==</span><span class="token number">2.2</span><span class="token number">.0</span>
eth<span class="token operator">-</span>account<span class="token operator">==</span><span class="token number">0.5</span><span class="token number">.9</span>
eth<span class="token operator">-</span><span class="token builtin">hash</span><span class="token operator">==</span><span class="token number">0.5</span><span class="token number">.0</span>
eth<span class="token operator">-</span>keyfile<span class="token operator">==</span><span class="token number">0.5</span><span class="token number">.1</span>
eth<span class="token operator">-</span>keys<span class="token operator">==</span><span class="token number">0.3</span><span class="token number">.4</span>
eth<span class="token operator">-</span>rlp<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.1</span>
eth<span class="token operator">-</span>typing<span class="token operator">==</span><span class="token number">2.3</span><span class="token number">.0</span>
eth<span class="token operator">-</span>utils<span class="token operator">==</span><span class="token number">1.9</span><span class="token number">.5</span>
executing<span class="token operator">==</span><span class="token number">0.8</span><span class="token number">.3</span>
fastjsonschema<span class="token operator">==</span><span class="token number">2.15</span><span class="token number">.3</span>
filestools<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.2</span>
flatbuffers<span class="token operator">==</span><span class="token number">2.0</span>
fonttools<span class="token operator">==</span><span class="token number">4.32</span><span class="token number">.0</span>
frozenlist<span class="token operator">==</span><span class="token number">1.3</span><span class="token number">.1</span>
hexbytes<span class="token operator">==</span><span class="token number">0.3</span><span class="token number">.0</span>
idna<span class="token operator">==</span><span class="token number">3.3</span>
image<span class="token operator">==</span><span class="token number">1.5</span><span class="token number">.33</span>
imageio<span class="token operator">==</span><span class="token number">2.16</span><span class="token number">.2</span>
importlib<span class="token operator">-</span>metadata<span class="token operator">==</span><span class="token number">4.10</span><span class="token number">.0</span>
importlib<span class="token operator">-</span>resources<span class="token operator">==</span><span class="token number">5.7</span><span class="token number">.1</span>
insightface<span class="token operator">==</span><span class="token number">0.6</span><span class="token number">.2</span>
interchange<span class="token operator">==</span><span class="token number">2021.0</span><span class="token number">.4</span>
ipfshttpclient<span class="token operator">==</span><span class="token number">0.8</span><span class="token punctuation">.</span>0a2
ipykernel<span class="token operator">==</span><span class="token number">6.13</span><span class="token number">.0</span>
ipython<span class="token operator">==</span><span class="token number">8.3</span><span class="token number">.0</span>
ipython<span class="token operator">-</span>genutils<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.0</span>
jedi<span class="token operator">==</span><span class="token number">0.18</span><span class="token number">.1</span>
Jinja2<span class="token operator">==</span><span class="token number">3.1</span><span class="token number">.2</span>
jmespath<span class="token operator">==</span><span class="token number">0.10</span><span class="token number">.0</span>
joblib<span class="token operator">==</span><span class="token number">1.1</span><span class="token number">.0</span>
jsonfield<span class="token operator">==</span><span class="token number">3.1</span><span class="token number">.0</span>
jsonschema<span class="token operator">==</span><span class="token number">4.5</span><span class="token number">.1</span>
jupyter<span class="token operator">-</span>client<span class="token operator">==</span><span class="token number">7.3</span><span class="token number">.0</span>
jupyter<span class="token operator">-</span>core<span class="token operator">==</span><span class="token number">4.10</span><span class="token number">.0</span>
jupyterlab<span class="token operator">-</span>pygments<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.2</span>
kiwisolver<span class="token operator">==</span><span class="token number">1.4</span><span class="token number">.2</span>
lru<span class="token operator">-</span><span class="token builtin">dict</span><span class="token operator">==</span><span class="token number">1.1</span><span class="token number">.8</span>
Markdown<span class="token operator">==</span><span class="token number">3.3</span><span class="token number">.6</span>
MarkupSafe<span class="token operator">==</span><span class="token number">2.1</span><span class="token number">.1</span>
matplotlib<span class="token operator">==</span><span class="token number">3.5</span><span class="token number">.1</span>
matplotlib<span class="token operator">-</span>inline<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.3</span>
mistune<span class="token operator">==</span><span class="token number">0.8</span><span class="token number">.4</span>
model<span class="token operator">-</span>index<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.11</span>
monotonic<span class="token operator">==</span><span class="token number">1.6</span>
multiaddr<span class="token operator">==</span><span class="token number">0.0</span><span class="token number">.9</span>
multidict<span class="token operator">==</span><span class="token number">6.0</span><span class="token number">.2</span>
mysqlclient<span class="token operator">==</span><span class="token number">2.1</span><span class="token number">.0</span>
nbclient<span class="token operator">==</span><span class="token number">0.6</span><span class="token number">.2</span>
nbconvert<span class="token operator">==</span><span class="token number">6.5</span><span class="token number">.0</span>
nbformat<span class="token operator">==</span><span class="token number">5.4</span><span class="token number">.0</span>
neo4j<span class="token operator">-</span>driver<span class="token operator">==</span><span class="token number">4.4</span><span class="token number">.3</span>
nest<span class="token operator">-</span>asyncio<span class="token operator">==</span><span class="token number">1.5</span><span class="token number">.5</span>
netaddr<span class="token operator">==</span><span class="token number">0.8</span><span class="token number">.0</span>
networkx<span class="token operator">==</span><span class="token number">2.8</span>
notebook<span class="token operator">==</span><span class="token number">6.4</span><span class="token number">.11</span>
numpy<span class="token operator">==</span><span class="token number">1.23</span><span class="token number">.2</span>
oauthlib<span class="token operator">==</span><span class="token number">3.1</span><span class="token number">.1</span>
onnx<span class="token operator">==</span><span class="token number">1.11</span><span class="token number">.0</span>
onnxruntime<span class="token operator">==</span><span class="token number">1.11</span><span class="token number">.0</span>
opencv<span class="token operator">-</span>contrib<span class="token operator">-</span>python<span class="token operator">==</span><span class="token number">4.5</span><span class="token number">.5</span><span class="token number">.64</span>
opencv<span class="token operator">-</span>python<span class="token operator">-</span>headless<span class="token operator">==</span><span class="token number">4.5</span><span class="token number">.5</span><span class="token number">.64</span>
openmim<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.5</span>
ordered<span class="token operator">-</span><span class="token builtin">set</span><span class="token operator">==</span><span class="token number">4.1</span><span class="token number">.0</span>
oss2<span class="token operator">==</span><span class="token number">2.15</span><span class="token number">.0</span>
packaging<span class="token operator">==</span><span class="token number">21.3</span>
pandas<span class="token operator">==</span><span class="token number">1.4</span><span class="token number">.2</span>
pandocfilters<span class="token operator">==</span><span class="token number">1.5</span><span class="token number">.0</span>
pansi<span class="token operator">==</span><span class="token number">2020.7</span><span class="token number">.3</span>
parsimonious<span class="token operator">==</span><span class="token number">0.8</span><span class="token number">.1</span>
parso<span class="token operator">==</span><span class="token number">0.8</span><span class="token number">.3</span>
pickleshare<span class="token operator">==</span><span class="token number">0.7</span><span class="token number">.5</span>
pilkit<span class="token operator">==</span><span class="token number">2.0</span>
Pillow<span class="token operator">==</span><span class="token number">9.0</span><span class="token number">.0</span>
prettytable<span class="token operator">==</span><span class="token number">3.2</span><span class="token number">.0</span>
prometheus<span class="token operator">-</span>client<span class="token operator">==</span><span class="token number">0.14</span><span class="token number">.1</span>
prompt<span class="token operator">-</span>toolkit<span class="token operator">==</span><span class="token number">3.0</span><span class="token number">.29</span>
protobuf<span class="token operator">==</span><span class="token number">3.20</span><span class="token number">.0</span>
psutil<span class="token operator">==</span><span class="token number">5.9</span><span class="token number">.0</span>
pure<span class="token operator">-</span><span class="token builtin">eval</span><span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.2</span>
py2neo<span class="token operator">==</span><span class="token number">2021.2</span><span class="token number">.3</span>
pycallgraph<span class="token operator">==</span><span class="token number">1.0</span><span class="token number">.1</span>
pycocotools<span class="token operator">==</span><span class="token number">2.0</span><span class="token number">.4</span>
pycparser<span class="token operator">==</span><span class="token number">2.21</span>
pycryptodome<span class="token operator">==</span><span class="token number">3.14</span><span class="token number">.1</span>
pyexiv2<span class="token operator">==</span><span class="token number">2.7</span><span class="token number">.1</span>
Pygments<span class="token operator">==</span><span class="token number">2.11</span><span class="token number">.2</span>
PyJWT<span class="token operator">==</span><span class="token number">1.7</span><span class="token number">.1</span>
pymongo<span class="token operator">==</span><span class="token number">4.1</span><span class="token number">.1</span>
pyparsing<span class="token operator">==</span><span class="token number">3.0</span><span class="token number">.8</span>
pyperclip<span class="token operator">==</span><span class="token number">1.8</span><span class="token number">.2</span>
pyrsistent<span class="token operator">==</span><span class="token number">0.18</span><span class="token number">.1</span>
python<span class="token operator">-</span>dateutil<span class="token operator">==</span><span class="token number">2.8</span><span class="token number">.2</span>
python<span class="token operator">-</span>mcs<span class="token operator">-</span>sdk<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.0</span>
python3<span class="token operator">-</span>openid<span class="token operator">==</span><span class="token number">3.2</span><span class="token number">.0</span>
pytz<span class="token operator">==</span><span class="token number">2021.3</span>
PyWavelets<span class="token operator">==</span><span class="token number">1.3</span><span class="token number">.0</span>
pywin32<span class="token operator">==</span><span class="token number">304</span>      <span class="token comment"># 得把这个包去掉，这个用于win下面的,# pywin32是一个第三方模块库，主要的作用是方便python开发者快速调用windows API的一个模块库。</span>
pywinpty<span class="token operator">==</span><span class="token number">2.0</span><span class="token number">.5</span>   <span class="token comment"># 得把这个包去掉，这个用于win下面的</span>
PyYAML<span class="token operator">==</span><span class="token number">6.0</span>
pyzmq<span class="token operator">==</span><span class="token number">22.3</span><span class="token number">.0</span>
q<span class="token operator">==</span><span class="token number">2.6</span>
qudida<span class="token operator">==</span><span class="token number">0.0</span><span class="token number">.4</span>
regex<span class="token operator">==</span><span class="token number">2022.4</span><span class="token number">.24</span>
requests<span class="token operator">==</span><span class="token number">2.27</span><span class="token number">.1</span>
requests<span class="token operator">-</span>oauthlib<span class="token operator">==</span><span class="token number">1.3</span><span class="token number">.0</span>
requests<span class="token operator">-</span>toolbelt<span class="token operator">==</span><span class="token number">0.9</span><span class="token number">.1</span>
rich<span class="token operator">==</span><span class="token number">11.0</span><span class="token number">.0</span>
rlp<span class="token operator">==</span><span class="token number">2.0</span><span class="token number">.1</span>
scikit<span class="token operator">-</span>image<span class="token operator">==</span><span class="token number">0.19</span><span class="token number">.2</span>
scikit<span class="token operator">-</span>learn<span class="token operator">==</span><span class="token number">1.0</span><span class="token number">.2</span>
scipy<span class="token operator">==</span><span class="token number">1.8</span><span class="token number">.0</span>
Send2Trash<span class="token operator">==</span><span class="token number">1.8</span><span class="token number">.0</span>
signals<span class="token operator">==</span><span class="token number">0.0</span><span class="token number">.2</span>
six<span class="token operator">==</span><span class="token number">1.16</span><span class="token number">.0</span>
soupsieve<span class="token operator">==</span><span class="token number">2.3</span><span class="token number">.2</span><span class="token punctuation">.</span>post1
sqlparse<span class="token operator">==</span><span class="token number">0.4</span><span class="token number">.2</span>
stack<span class="token operator">-</span>data<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.0</span>
swapper<span class="token operator">==</span><span class="token number">1.3</span><span class="token number">.0</span>
tabulate<span class="token operator">==</span><span class="token number">0.8</span><span class="token number">.9</span>
terminado<span class="token operator">==</span><span class="token number">0.13</span><span class="token number">.3</span>
terminaltables<span class="token operator">==</span><span class="token number">3.1</span><span class="token number">.10</span>
threadpoolctl<span class="token operator">==</span><span class="token number">3.1</span><span class="token number">.0</span>
tifffile<span class="token operator">==</span><span class="token number">2022.4</span><span class="token number">.8</span>
tinycss2<span class="token operator">==</span><span class="token number">1.1</span><span class="token number">.1</span>
toolz<span class="token operator">==</span><span class="token number">0.12</span><span class="token number">.0</span>
torch<span class="token operator">==</span><span class="token number">1.12</span><span class="token number">.1</span><span class="token operator">+</span>cu113
torchaudio<span class="token operator">==</span><span class="token number">0.12</span><span class="token number">.1</span><span class="token operator">+</span>cu113
torchvision<span class="token operator">==</span><span class="token number">0.13</span><span class="token number">.1</span><span class="token operator">+</span>cu113
tornado<span class="token operator">==</span><span class="token number">6.1</span>
tqdm<span class="token operator">==</span><span class="token number">4.64</span><span class="token number">.0</span>
traitlets<span class="token operator">==</span><span class="token number">5.1</span><span class="token number">.1</span>
transaction<span class="token operator">==</span><span class="token number">3.0</span><span class="token number">.1</span>
typing_extensions<span class="token operator">==</span><span class="token number">4.1</span><span class="token number">.1</span>
tzdata<span class="token operator">==</span><span class="token number">2021.5</span>
urllib3<span class="token operator">==</span><span class="token number">1.26</span><span class="token number">.8</span>
varint<span class="token operator">==</span><span class="token number">1.0</span><span class="token number">.2</span>
wcwidth<span class="token operator">==</span><span class="token number">0.2</span><span class="token number">.5</span>
web3<span class="token operator">==</span><span class="token number">5.30</span><span class="token number">.0</span>
webencodings<span class="token operator">==</span><span class="token number">0.5</span><span class="token number">.1</span>
websockets<span class="token operator">==</span><span class="token number">9.1</span>
yapf<span class="token operator">==</span><span class="token number">0.32</span><span class="token number">.0</span>
yarl<span class="token operator">==</span><span class="token number">1.8</span><span class="token number">.1</span>
zipp<span class="token operator">==</span><span class="token number">3.7</span><span class="token number">.0</span>
zope<span class="token punctuation">.</span>interface<span class="token operator">==</span><span class="token number">5.4</span><span class="token number">.0</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br></div></div><h5 id="anyjson">anyjson</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Collecting <span class="token assign-left variable">anyjson</span><span class="token operator">==</span><span class="token number">0.3</span>.3
  Downloading http://mirrors.cloud.aliyuncs.com/pypi/packages/c3/4d/d4089e1a3dd25b46bebdb55a992b0797cff657b4477bc32ce28038fdecbc/anyjson-0.3.3.tar.gz <span class="token punctuation">(</span><span class="token number">8.3</span> kB<span class="token punctuation">)</span>
  Preparing metadata <span class="token punctuation">(</span>setup.py<span class="token punctuation">)</span> <span class="token punctuation">..</span>. error
  error: subprocess-exited-with-error
  
  × python setup.py egg_info did not run successfully.
  │ <span class="token builtin class-name">exit</span> code: <span class="token number">1</span>
  ╰─<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token number">3</span> lines of output<span class="token punctuation">]</span>
      /home/venv_diary/lib/python3.8/site-packages/setuptools/dist.py:723: UserWarning: Usage of dash-separated <span class="token string">'index-url'</span> will not be supported <span class="token keyword">in</span> future versions. Please use the underscore name <span class="token string">'index_url'</span> instead
        warnings.warn<span class="token punctuation">(</span>
      error <span class="token keyword">in</span> anyjson setup command: use_2to3 is invalid.
      <span class="token punctuation">[</span>end of output<span class="token punctuation">]</span>
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
error: metadata-generation-failed

× Encountered error <span class="token keyword">while</span> generating package metadata.
╰─<span class="token operator">&gt;</span> See above <span class="token keyword">for</span> output.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h5 id="celery-with-redis">celery-with-redis</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>INFO: pip is looking at multiple versions of <span class="token operator">&lt;</span>Python from Requires-Python<span class="token operator">&gt;</span> to determine <span class="token function">which</span> version is compatible with other requirements. This could take a while.
ERROR: Cannot <span class="token function">install</span> -r requirements.txt <span class="token punctuation">(</span>line <span class="token number">25</span><span class="token punctuation">)</span> and <span class="token assign-left variable">celery</span><span class="token operator">==</span><span class="token number">5.2</span>.7 because these package versions have conflicting dependencies.

The conflict is caused by:
    The user requested <span class="token assign-left variable">celery</span><span class="token operator">==</span><span class="token number">5.2</span>.7
    celery-with-redis <span class="token number">3.0</span> depends on celery<span class="token operator">&lt;</span><span class="token number">4.0</span> and <span class="token operator">&gt;=</span><span class="token number">3.0</span>

To fix this you could try to:
<span class="token number">1</span>. loosen the range of package versions you've specified
<span class="token number">2</span>. remove package versions to allow pip attempt to solve the dependency conflict

ERROR: ResolutionImpossible: <span class="token keyword">for</span> <span class="token builtin class-name">help</span> visit https://pip.pypa.io/en/latest/topics/dependency-resolution/<span class="token comment">#dealing-with-dependency-conflicts</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="all-the-error-packages">all the error packages</h5> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pywin32<span class="token operator">==</span><span class="token number">304</span>      <span class="token comment"># 得把这个包去掉，这个用于win下面的,# pywin32是一个第三方模块库，主要的作用是方便python开发者快速调用windows API的一个模块库。</span>
pywinpty<span class="token operator">==</span><span class="token number">2.0</span><span class="token number">.5</span>   <span class="token comment"># 得把这个包去掉，这个用于win下面的</span>
anyjson<span class="token operator">==</span><span class="token number">0.3</span><span class="token number">.3</span>  <span class="token comment"># delete first</span>
pycallgraph<span class="token operator">==</span><span class="token number">1.0</span><span class="token number">.1</span>  <span class="token comment"># delete first</span>
celery<span class="token operator">-</span><span class="token keyword">with</span><span class="token operator">-</span>redis<span class="token operator">==</span><span class="token number">3.0</span>  <span class="token comment"># version conflict</span>
torch<span class="token operator">==</span><span class="token number">1.12</span><span class="token number">.1</span><span class="token operator">+</span>cu113  <span class="token comment"># win is different with linux</span>
torchaudio<span class="token operator">==</span><span class="token number">0.12</span><span class="token number">.1</span><span class="token operator">+</span>cu113  <span class="token comment"># win is different with linux</span>
torchvision<span class="token operator">==</span><span class="token number">0.13</span><span class="token number">.1</span><span class="token operator">+</span>cu113  <span class="token comment"># win is different with linux</span>
click<span class="token operator">==</span><span class="token number">8.1</span><span class="token number">.3</span>
openmim<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.5</span> <span class="token comment"># delete first</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="collect-the-static-files">collect the static files</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home/Backend<span class="token comment"># python3 manage.py collectstatic</span>

<span class="token number">1965</span> static files copied to <span class="token string">'/home/Backend/collected_static'</span><span class="token builtin class-name">.</span>     <span class="token operator">&lt;</span>----------
<span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home/Backend<span class="token comment"># ls</span>
 all_feats.txt             celerybeat-schedule.dir   colors.txt   deep_diary.ipynb   graph.png           manage.py      package-lock.json   static
 article                   center_feats.txt          comment      face              <span class="token string">'Jupyter Notebook'</span>   media          project             tags
 celerybeat-schedule.bak   collected_static          db.sqlite3   favicon.ico        library             mycelery       README.md           user_info
 celerybeat-schedule.dat   colors.pkl                deep_diary   frontend           LICENSE             package.json   requirements.txt    utils

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="migrate">migrate</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/home/Backend<span class="token comment"># python3 manage.py migrate</span>
Operations to perform:
  Apply all migrations: admin, article, auth, comment, contenttypes, face, library, project, sessions, taggit, user_info, utils
Running migrations:
  Applying contenttypes.0001_initial<span class="token punctuation">..</span>. OK
  Applying taggit.0001_initial<span class="token punctuation">..</span>. OK
  Applying taggit.0002_auto_20150616_2121<span class="token punctuation">..</span>. OK
  Applying contenttypes.0002_remove_content_type_name<span class="token punctuation">..</span>. OK
  Applying taggit.0003_taggeditem_add_unique_index<span class="token punctuation">..</span>. OK
  Applying auth.0001_initial<span class="token punctuation">..</span>. OK
  Applying auth.0002_alter_permission_name_max_length<span class="token punctuation">..</span>. OK
。。。。。。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="unknown-database-deep-diary">Unknown database 'deep-diary'</h5> <p>create an new database</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123102805177.png" alt="image-20221123102805177"></p> <p>如果migrate 报错，可以尝试用</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>deep_diary# python3 manage.py migrate --fake
初始化已存在的表 migrate --fake-initial
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>代码部署基本就完成了，接下来就是配置 Nginx 。</p> <h5 id="create-superuser">create superuser</h5> <div class="language-·shell line-numbers-mode"><pre class="language-text"><code>(venv_diary) root@deep-diary:/home/Backend# python manage.py createsuperuser
Username: blue
Email address: deep-diary@qq.com
Password: 
Password (again): 
Superuser created successfully.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="nginx">Nginx</h3> <p>server IP: http://121.43.166.145/</p> <p>Nginx 欢迎界面这个默认配置显然是不能用的，所以需要重新写 Nginx 的配置文件。 <code>/etc/nginx/sites-available</code> 目录是定义 <strong>Nginx 可用配置</strong>的地方。输入指令创建配置文件 <code>gallery</code> 并打开 <strong>vim 编辑器</strong>：</p> <h4 id="config-the-gallery-nginx-file">config the gallery Nginx file</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/etc/nginx/sites-available<span class="token comment"># vim gallery</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>server <span class="token punctuation">{</span>
  charset utf-8<span class="token punctuation">;</span>
  listen <span class="token number">80</span><span class="token punctuation">;</span>
  server_name <span class="token number">121.43</span>.166.145<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>

  <span class="token comment"># 定义 server 的根路径</span>
  <span class="token comment"># 修改为你的项目的路径</span>
  root /home/Backend<span class="token punctuation">;</span>

  <span class="token comment"># 以下4项都是在给静态资源配置转发路径</span>
  <span class="token comment"># 注意路径名称一定要正确</span>
  <span class="token comment"># 特别是中横线 - 和下划线 _ 别弄混了</span>
  location /static <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /media <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/media<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /js <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /css <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/css<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /fonts <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/fonts<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /img <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/img<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token comment"># 将接口及后台请求转发给 Gunicorn</span>
    location ~ <span class="token punctuation">(</span>^/api<span class="token operator">|</span>^/admin<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
    proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>
    proxy_pass http://unix:/tmp/121.43.166.145.socket<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>
  <span class="token punctuation">}</span>

  <span class="token comment"># 其他所有请求均直接请求 Vue 打包的 html 文件</span>
  location / <span class="token punctuation">{</span>
    try_files /collected_static/index.html <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>此配置会监听 80 端口（通常 http 请求的端口），监听的 IP 地址写你自己的<strong>服务器公网 IP</strong>。</p> <p>配置中有3个核心规则：</p> <ul><li>如果请求静态资源，则转发到对应目录中寻找静态资源</li> <li>如果请求接口数据或后台页面，则转发给 Gunicorn</li> <li>其他请求则直接请求 Vue 打包的前端文件</li></ul> <blockquote><p>如果你已经申请好域名了，就把配置中有 IP 的地方都修改为域名，比如：server_name www.deep-diary.com。</p></blockquote> <p>写好后就退出 <code>vim</code> 编辑器，回到命令行。因为我们写的只是 Nginx 的<strong>可用配置</strong>，所以还需要把这个配置文件链接到<strong>在用配置</strong>上去：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/etc/nginx/sites-available<span class="token comment"># ln -s /etc/nginx/sites-available/gallery /etc/nginx/sites-enabled</span>
<span class="token function">service</span> nginx restart //restart the nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="combine-the-blog-and-gallery">combine the blog and gallery</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 未带www的请求，统一分发到https://www上</span>
server <span class="token punctuation">{</span>
    listen <span class="token number">80</span><span class="token punctuation">;</span>
    listen <span class="token number">443</span> ssl<span class="token punctuation">;</span>
    server_name  deep-diary.com<span class="token punctuation">;</span>
    <span class="token builtin class-name">return</span> <span class="token number">301</span> https://www.deep-diary.com<span class="token variable">$request_uri</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment"># https gallery请求处理</span>
server <span class="token punctuation">{</span>
  charset utf-8<span class="token punctuation">;</span>
  listen <span class="token number">443</span> default_server ssl<span class="token punctuation">;</span> <span class="token comment"># a duplicate default server for 0.0.0.0:443 in /etc/nginx/sites-enabled/deep-diary:12, so we need to delete the default_server</span>
  server_name www.deep-diary.com<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>
  ssl_certificate /etc/nginx/ssh/7968498_www.deep-diary.com.pem<span class="token punctuation">;</span>
  ssl_certificate_key /etc/nginx/ssh/7968498_www.deep-diary.com.key<span class="token punctuation">;</span>

  <span class="token comment"># 定义 server 的根路径</span>
  <span class="token comment"># 修改为你的项目的路径</span>
  root /home/Backend<span class="token punctuation">;</span>

  <span class="token comment"># 以下4项都是在给静态资源配置转发路径</span>
  <span class="token comment"># 注意路径名称一定要正确</span>
  <span class="token comment"># 特别是中横线 - 和下划线 _ 别弄混了</span>
  location /static <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  location /media <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/media<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  location /js <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  location /css <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/css<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  location /fonts <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/fonts<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  location /img <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/img<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment"># 将接口及后台请求转发给 Gunicorn</span>
    location ~ <span class="token punctuation">(</span>^/api<span class="token operator">|</span>^/admin<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
    proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>
    proxy_pass http://unix:/tmp/www.deep-diary.com.socket<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>
  <span class="token punctuation">}</span>

  <span class="token comment"># 其他所有请求均直接请求 Vue 打包的 html 文件</span>
  location / <span class="token punctuation">{</span>
    try_files /collected_static/index.html <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h4 id="常用命令">常用命令</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nginx -s reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="配置文件">配置文件</h4> <p>配置文件位置：</p> <p>/usr/local/nginx/conf/nginx.conf</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 全局块</span>
worker_processes	<span class="token number">1</span>  <span class="token comment"># 处理并发的数量，越大，并发越多</span>

<span class="token comment"># events 块， 影响Nginx 服务器与用户的网络链接，比如：</span>
worker_connections	<span class="token number">1024</span>：	支持的最大连接数

<span class="token comment"># http 块</span>
http 全局块
server 块 
location 块
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="配置实例">配置实例</h4> <h5 id="反向代理">反向代理</h5> <p>开放端口</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>firewall-cmd --add-port<span class="token operator">=</span><span class="token number">8080</span>/tcp --permanent <span class="token comment"># 开放端口</span>
firewall-cmd --reload
firewall-cm --list-all  <span class="token comment"># 查看已经开发的端口</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>server<span class="token punctuation">{</span>
	listen		<span class="token number">9001</span><span class="token punctuation">;</span>
	server_name	<span class="token number">192.168</span>.17.129
	location ~ /gallery/ <span class="token punctuation">{</span>
		proxy_pass http://127.0.0.1:8000
    <span class="token punctuation">}</span>
    location ~ /blog/ <span class="token punctuation">{</span>
        proxy_pass http://127.0.0.1:8001
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment"># 需要开放上述端口</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>正则表达式</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20220901210958780.png" alt="image-20220901210958780"></p> <h5 id="负载均衡">负载均衡</h5> <h5 id="动静分离">动静分离</h5> <p>启动nginx 服务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(env) root@deep-diary:/home/deep_diary# sudo service nginx start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在我们就可以用公网ip来访问这个nginx引导页了，哈哈，小功告成，先喝口小咖啡！</p> <p>前路漫漫，咱们接着继续努力</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/e09b1d4f98c84bbcb2a2dae071ce4780.png" alt="Django搭建深度日记：将项目部署到服务器-深度日记官方网站"></p> <p>Nginx 首页</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(env) root@deep-diary:/home/deep_diary# cd /etc/nginx/sites-available/
(env) root@deep-diary:/etc/nginx/sites-available# ls
default
(env) root@deep-diary:/etc/nginx/sites-available# vi deep-diary.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>关于 vi 编辑器如何使用也不赘述了，这里只说两个最基本的操作：</p> <ul><li>按 i 切换到<strong>编辑模式</strong>，这时候才可以进行输入、删除、修改等操作</li> <li>按 Ctrl + c 退回到<strong>命令模式</strong>，然后输入 :wq + Enter 保存文件修改并退回到服务器命令行</li></ul> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/2132c92643004fb7a88f4dd81c8f37a4.png" alt="Django搭建深度日记：将项目部署到服务器-深度日记官方网站"></p> <p>此配置会监听 80 端口（通常 http 请求的端口），监听的 IP 地址写你自己的<strong>服务器公网 IP</strong>。</p> <p>配置中有3个规则：</p> <ul><li>如果请求 static 路径则由 Nginx 转发到目录中寻找静态资源</li> <li>如果请求 media 路径则由 Nginx 转发到目录中寻找媒体资源</li> <li>其他请求则交给 Django 处理</li></ul> <blockquote><p>如果你已经申请好域名了，就把配置中有 IP 的地方都修改为域名，比如：server_name www.deep-diary.com;</p></blockquote> <p>写好后就退出 vi 编辑器，回到命令行。因为我们写的只是 Nginx 的<strong>可用配置</strong>，所以还需要把这个配置文件链接到<strong>在用配置</strong>上去：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(env) root@deep-diary: sudo ln -s /etc/nginx/sites-available/deep-diary.com /etc/nginx/sites-enabled
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ln [参数][源文件或目录][目标文件或目录]</p> <p>-s : 表示软链接符号，关于这个命令的更多参数，可以参考如下博文</p> <p><a href="https://www.cnblogs.com/huchong/p/9836325.html" target="_blank" rel="noopener noreferrer">linux每日命令(3)：ln命令 - 听风。 - 博客园<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>至此 Nginx 就配置好了，接下来搞定 Gunicorn。</p> <h4 id="配置相册">配置相册</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>server <span class="token punctuation">{</span>
  charset utf-8<span class="token punctuation">;</span>
  listen <span class="token number">80</span><span class="token punctuation">;</span>
  server_name <span class="token number">121.43</span>.166.145<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>

  <span class="token comment"># 定义 server 的根路径</span>
  <span class="token comment"># 修改为你的项目的路径</span>
  root /home/Backend<span class="token punctuation">;</span>

  <span class="token comment"># 以下4项都是在给静态资源配置转发路径</span>
  <span class="token comment"># 注意路径名称一定要正确</span>
  <span class="token comment"># 特别是中横线 - 和下划线 _ 别弄混了</span>
  location /static <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/static<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /media <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/media<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /js <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/static/js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /css <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/static/css<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment"># 将接口及后台请求转发给 Gunicorn</span>
   location ~ <span class="token punctuation">(</span>^/api<span class="token operator">|</span>^/admin<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
     proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>
     proxy_pass http://unix:/tmp/121.43.166.145.socket<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>
   <span class="token punctuation">}</span>

  <span class="token comment"># 其他所有请求均直接请求 Vue 打包的 html 文件</span>
  location / <span class="token punctuation">{</span>
    try_files /collected_static/index.html <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
server <span class="token punctuation">{</span>
  charset utf-8<span class="token punctuation">;</span>
  listen <span class="token number">8000</span><span class="token punctuation">;</span>
  server_name <span class="token number">121.43</span>.166.145<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>
    <span class="token comment"># 将接口及后台请求转发给 Gunicorn</span>
  location /static <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/static<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  location /js <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/static/js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  location /css <span class="token punctuation">{</span>
    <span class="token builtin class-name">alias</span> /home/Backend/collected_static/static/css<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  location ~ <span class="token punctuation">(</span>^/api<span class="token operator">|</span>^/admin<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
    proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>
    proxy_pass http://unix:/tmp/121.43.166.145.socket<span class="token punctuation">;</span>  <span class="token comment"># 改成你的 IP</span>
  <span class="token punctuation">}</span>

  <span class="token comment"># 定义 server 的根路径</span>
  <span class="token comment"># 修改为你的项目的路径</span>
  root /home/Backend<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">ln</span> -s gallery /etc/nginx/sites-enabled <span class="token comment"># 写好后就退出 vim 编辑器，回到命令行。因为我们写的只是 Nginx 的可用配置，所以还需要把这个配置文件链接到在用配置上去：</span>

<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ~$ <span class="token function">service</span> nginx restart
<span class="token comment"># 将 IP 改为你的公网 IP</span>
<span class="token comment"># .wsgi 前面为 Django 配置文件所在的目录名</span>
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ~$ gunicorn --bind unix:/tmp/121.43.166.145.socket deep_diary.wsgi:application

ModuleNotFoundError: No module named <span class="token string">'deep_diary'</span>   <span class="token comment"># 报错</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="gunicorn">Gunicorn</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:/etc/nginx/sites-enabled<span class="token comment"># gunicorn --bind unix:/tmp/121.43.166.145.socket deep_diary.wsgi:appplication</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>(env) root@deep-diary:/home/deep_diary# pip3 install gunicorn
Looking in indexes: http://mirrors.cloud.aliyuncs.com/pypi/simple/
Collecting gunicorn
  Downloading http://mirrors.cloud.aliyuncs.com/pypi/packages/e4/dd/5b190393e6066286773a67dfcc2f9492058e9b57c4867a95f1ba5caf0a83/gunicorn-20.1.0-py3-none-any.whl (79 kB)
     |████████████████████████████████| 79 kB 20.2 MB/s 
Requirement already satisfied: setuptools&gt;=3.0 in /usr/lib/python3/dist-packages (from gunicorn) (45.2.0)
Installing collected packages: gunicorn
Successfully installed gunicorn-20.1.0
(env) root@deep-diary:/home/deep_diary# sudo service nginx reload
(env) root@deep-diary:/home/deep_diary# gunicorn --bind unix:/tmp/121.43.166.145.socket deep_diary.wsgi:application
[2022-01-22 07:31:00 +0800] [57670] [INFO] Starting gunicorn 20.1.0
[2022-01-22 07:31:00 +0800] [57670] [INFO] Listening at: unix:/tmp/121.43.166.145.socket (57670)
[2022-01-22 07:31:00 +0800] [57670] [INFO] Using worker: sync
[2022-01-22 07:31:00 +0800] [57673] [INFO] Booting worker with pid: 57673
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这里的三个步骤分别是：</p> <ul><li>安装 Gunicorn</li> <li>重启 Nginx 服务</li> <li>启动 Gunicorn</li></ul> <p>接下来，刷新浏览器试试，是不是很惊喜，自己开发的网站终于上线了</p> <h3 id="test-the-result">Test the result</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">121.43</span><span class="token number">.166</span><span class="token number">.145</span><span class="token operator">/</span>api<span class="token operator">/</span>    <span class="token comment"># api result</span>
http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">121.43</span><span class="token number">.166</span><span class="token number">.145</span><span class="token operator">/</span>admin<span class="token operator">/</span>  <span class="token comment"># admin</span>
http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">121.43</span><span class="token number">.166</span><span class="token number">.145</span><span class="token operator">/</span>static<span class="token operator">/</span>favicon<span class="token punctuation">.</span>ico  <span class="token comment"># http://121.43.166.145/static ---》related to the collected_static folder</span>
http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">121.43</span><span class="token number">.166</span><span class="token number">.145</span><span class="token operator">/</span>img<span class="token operator">/</span>logo_lg<span class="token punctuation">.</span>8de80a86<span class="token punctuation">.</span>png <span class="token comment"># http://121.43.166.145/img/ ---》 related to the collected_static/img, which is the same for fonts, js, css</span>


https<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>deep<span class="token operator">-</span>diary<span class="token punctuation">.</span>com<span class="token operator">/</span>img<span class="token operator">/</span>logo_lg<span class="token punctuation">.</span>8de80a86<span class="token punctuation">.</span>png
https<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>deep<span class="token operator">-</span>diary<span class="token punctuation">.</span>com<span class="token operator">/</span>media<span class="token operator">/</span>blue<span class="token operator">/</span>img<span class="token operator">/</span><span class="token number">2021</span><span class="token operator">/</span><span class="token number">07</span><span class="token operator">/</span><span class="token number">04</span><span class="token operator">/</span>IMG_20210704_225839<span class="token punctuation">.</span>jpg
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="check-the-production-backend-ip">check the production backend IP: <img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123210941000.png" alt="image-20221123210941000"></h4> <h4 id="check-all-the-api-start-with-api">check all the api start with /api/...<img src="C:%5CUsers%5CBlue%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221123211200464.png" alt="image-20221123211200464"></h4> <h4 id="check-the-role-of-the-user">check the role of the user</h4> <p>at first, the role of the user is empty, then the the <code>api</code> will back the 500 issue.</p> <p>so we need to set the role of the user like <strong><code>admin</code></strong></p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123211417981.png" alt="image-20221123211417981"></p> <p>Since now, everything goes right, we could visit the web based on the ip</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123212338487.png" alt="image-20221123212338487"></p> <p>开发的网站终于上线了</p> <p>终于，大功告成了，可以洗脸睡觉了！！！</p> <h3 id="unexpected-token">Unexpected token '&lt;'</h3> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123203310882.png" alt="image-20221123203310882"></p> <p>since the graph is based on <code>jquery</code>, however, here comes an error, couldn't find the <code>jquery</code>,</p> <p><a href="https://www.jianshu.com/p/6c3c33c43509" target="_blank" rel="noopener noreferrer">Uncaught SyntaxError: Unexpected token &lt; - 简书 (jianshu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="reason">Reason</h4> <p>the related <code>css</code> and <code>js</code>, not located in static folder</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./lib/interactive-graph-0.1.0/interactive-graph.min.css<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./lib/jquery-3.2.1/jquery-3.2.1.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./lib/jquery-3.2.1/jquery-ui.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./lib/jquery-3.2.1/jquery-ui.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./lib/font-awesome-4.7.0/css/font-awesome.min.css<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123204305722.png" alt="image-20221123204305722"></p> <h4 id="solution">Solution</h4> <h5 id="use-cdn-instead">use CDN instead</h5> <h5 id="move-the-cssandjsout-of-lib">move the <code>css</code>and<code>js</code>out of lib.</h5> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123205700193.png" alt="image-20221123205700193"></p> <p>replace the <code>lib</code> to <code>static</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;static/interactive-graph-0.1.0/interactive-graph.min.css<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;static/jquery-3.2.1/jquery-3.2.1.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
      <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;static/jquery-3.2.1/jquery-ui.css<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;static/jquery-3.2.1/jquery-ui.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;static/font-awesome-4.7.0/css/font-awesome.min.css<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="uploading-issue">uploading issue</h3> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/image-20221123232746578.png" alt="image-20221123232746578"></p> <h4 id="solution-2">solution</h4> <p>change<code>this.action</code> before uploading</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>      <span class="token function">handleClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>picture <span class="token operator">=</span> <span class="token string">'picture'</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>allImgNum <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgNum <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgSuccessNum <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgErrorNum <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'development'</span> <span class="token operator">===</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// this.api = process.env.VUE_APP_BASE_API</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>api <span class="token operator">=</span> baseURL
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>api <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>protocol<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">//</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>action <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>api <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url     <span class="token operator">&lt;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token keyword">this</span> is <span class="token keyword">new</span> <span class="token class-name">added</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this.action:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>action<span class="token punctuation">,</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">,</span> baseURL<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dialogFormVisible <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="cudaexecutionprovider">CUDAExecutionProvider</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>INFO: **************img instance have been created, saving face info now<span class="token punctuation">..</span>.
INFO: insight face detecting the face now <span class="token punctuation">..</span>. 
/home/venv_diary/lib/python3.8/site-packages/onnxruntime/capi/onnxruntime_inference_collection.py:55: UserWarning: Specified provider <span class="token string">'CUDAExecutionProvider'</span> is not <span class="token keyword">in</span> available provider names.Available providers: <span class="token string">'CPUExecutionProvider'</span>
  warnings.warn<span class="token punctuation">(</span><span class="token string">&quot;Specified provider '{}' is not in available provider names.&quot;</span>

<span class="token punctuation">(</span>venv_diary<span class="token punctuation">)</span> root@deep-diary:~<span class="token comment"># python3</span>
Python <span class="token number">3.8</span>.10 <span class="token punctuation">(</span>default, Nov <span class="token number">26</span> <span class="token number">2021</span>, <span class="token number">20</span>:14:08<span class="token punctuation">)</span> 
<span class="token punctuation">[</span>GCC <span class="token number">9.3</span>.0<span class="token punctuation">]</span> on linux
Type <span class="token string">&quot;help&quot;</span>, <span class="token string">&quot;copyright&quot;</span>, <span class="token string">&quot;credits&quot;</span> or <span class="token string">&quot;license&quot;</span> <span class="token keyword">for</span> <span class="token function">more</span> information.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token function">import</span> cv2
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token function">import</span> numpy as np
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token function">import</span> insightface
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> from insightface.app <span class="token function">import</span> FaceAnalysis
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> from insightface.data <span class="token function">import</span> get_image as ins_get_image
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> app <span class="token operator">=</span> FaceAnalysis<span class="token punctuation">(</span>providers<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'CUDAExecutionProvider'</span>, <span class="token string">'CPUExecutionProvider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
/home/venv_diary/lib/python3.8/site-packages/onnxruntime/capi/onnxruntime_inference_collection.py:55: UserWarning: Specified provider <span class="token string">'CUDAExecutionProvider'</span> is not <span class="token keyword">in</span> available provider names.Available providers: <span class="token string">'CPUExecutionProvider'</span>
  warnings.warn<span class="token punctuation">(</span><span class="token string">&quot;Specified provider '{}' is not in available provider names.&quot;</span>
Killed

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h5 id="reason-2">Reason</h5> <p>the ECS out of memory</p> <p>the insightface need nearly 700M memory</p> <h3 id="prepare-a-bash">prepare a bash</h3> <p><code>vim deep-diary.sh</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">source</span> /home/venv_diary/bin/activate
<span class="token builtin class-name">cd</span> /home/Backend
gunicorn --bind unix:/tmp/121.43.166.145.socket deep_diary.wsgi:application
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>after prepare the <code>deep-diary.sh</code> file, we need to change the mod</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">chmod</span> <span class="token number">777</span> deep-diary.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="update-the-frontend">update the frontend</h3> <h4 id="upload-the-dist-folder-to-home-backend-frontend-through-winscp">upload the dist folder to <code>home/Backend/frontend</code> through <code>WinSCP</code></h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /home/Backend
<span class="token function">rm</span> -rf ./collected_static
python3 manage.py collectstatic
<span class="token function">mv</span> collected_static/static/* collected_static/  <span class="token comment">#move the frontend static files to backend static folder</span>

<span class="token assign-left variable">ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> -ef<span class="token operator">|</span><span class="token function">grep</span> deep_diary<span class="token operator">|</span><span class="token function">grep</span> gunicorn<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print $2}'</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> --- the process is <span class="token variable">$ID</span> ---
<span class="token function">kill</span> -9  <span class="token variable">$ID</span>
<span class="token builtin class-name">echo</span>  <span class="token string">&quot;Killed <span class="token variable">$ID</span>&quot;</span>

<span class="token function">nohup</span> gunicorn --bind unix:/tmp/121.43.166.145.socket deep_diary.wsgi:application<span class="token operator">&amp;</span>
<span class="token function">nohup</span> gunicorn --bind unix:/tmp/www.deep-diary.com.socket deep_diary.wsgi:application<span class="token operator">&amp;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="接下来的工作">接下来的工作</h3> <ul><li>==后台人脸识别报错，需要单步调试==</li> <li>==linux 端实现异步操作，开启图片信息提取==</li> <li>==媒体资源部署道oss服务器==</li></ul> <p><strong>后期运维</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>通过WinSCP 上传更新后的代码到服务器
python3 manage.py collectstatic  重新收集静态文件
python3 manage.py migrate  如果数据库设计有变化，需要进行数据迁移
# 重启 gunicorn
pkill gunicorn
gunicorn --bind unix:/tmp/121.43.166.145.socket deep_diary.wsgi:application
sudo service nginx reload   如果nginx 有所更改，需要执行此命令进行重新加载
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这里执行一次代码更新，需要的命令很多，加上cd更改目录的指令，部署过程有十几条，后续可以考虑编写一个批处理脚步进行快速执行（待更新）。</p> <p><strong>域名及优化</strong></p> <p>相对部署来说，域名配置就很容易了。阿里云提供域名的购买、备案（顶级域名必须，约10个工作日）、解析服务，简直全家桶有没有。重点提醒有了域名之后要改的地方：</p> <ul><li>settings.py 中的 ALLOWED_HOSTS</li> <li>Nginx 中与 IP/域名 有关的位置</li> <li>Gunicorn 中与 IP/域名 有关的位置</li></ul> <p>域名搞定之后，接着就可以着手考虑把网站升级为 https 版本了，这是大趋势，一定要做。</p> <p>另外，开发时为了效率把所有静态资源都下载到本地，但是部署时不推荐这样做，原因是静态文件通常体积都较大，你花血汗钱买的服务器载入会很慢。尽量远程 CDN 调用（这个会在后续文章发布）<a href="https://www.bootcdn.cn/" target="_blank" rel="noopener noreferrer">BootCDN - Bootstrap 中文网开源项目免费 CDN 加速服务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>下一节，咱们来唠唠深度日记网站的基本功能</p> <p>鸣谢：本文参考了杜塞大神的博客教程，再次表示感谢</p> <p><a href="https://www.dusaiphoto.com/article/71/" target="_blank" rel="noopener noreferrer">Django搭建个人博客：将项目部署到服务器 - 杜赛的博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>新建数据库</p> <p>至此，我们已经搞定了mysql数据库的连接，下一节，我们再一起尝试下项目部署</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token number">121.43</span><span class="token number">.166</span><span class="token number">.145</span>  一年的版本
root
Deep<span class="token operator">-</span>diary666

deep<span class="token operator">-</span>diary 服务器
<span class="token number">121.43</span><span class="token number">.166</span><span class="token number">.145</span> 
密码 Deep<span class="token operator">-</span>diary666

数据库
mysql <span class="token operator">-</span>u root <span class="token operator">-</span>proot
mysql <span class="token operator">-</span>u blue <span class="token operator">-</span>pblue

超级用户账号密码
deep<span class="token operator">-</span>diary
deep<span class="token operator">-</span>diary
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><a href="https://blog.csdn.net/yhjahjj1314/article/details/80998807" target="_blank" rel="noopener noreferrer">Ubuntu服务器版安装MySQL数据库_往事只能回味味道的博客-CSDN博客_ubuntu服务器装数据库<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/skh2015java/article/details/80156278" target="_blank" rel="noopener noreferrer">ubuntu系统下mysql重置密码和修改密码操作_skh2015java的博客-CSDN博客_ubuntu重置mysql<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/java_cai_niao_han/article/details/110442608" target="_blank" rel="noopener noreferrer">(10条消息) mysql8版本执行 grant all privileges on <em>.</em>  to  ‘root‘@‘%‘  identified by ‘root‘  with grant option； 会报错_java_cai_niao_han的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>授权远程登入</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>mysql -h <span class="token number">192.168</span>.5.116 -P <span class="token number">3306</span> -u root -p123456   //显示密码登陆
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>netstat -tln 查看服务器开放的端口号</p> <p>通过<code>curl ifconfig.me</code>获取</p> <div class="language-reStructuredText line-numbers-mode"><pre class="language-text"><code>hostname -I
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-text line-numbers-mode"><pre class="language-text"><code>问题清单：
(10条消息) ubuntu安装mysql后无法远程连接_zhangxiaohui4445的博客-CSDN博客
解决无法远程连接mysql 问题
1. 需要授权登入
2. 阿里云需要开启相关的端口
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="icp备案">ICP备案</h2> <h3 id="什么是icp备案">什么是ICP备案</h3> <p>国家对非经营性互联网信息服务实行备案制度，对经营性互联网信息服务实行许可制度。未取得许可或者未履行备案手续的，不得从事互联网信息服务。即所有对中国大陆提供服务的网站都必须先进行ICP备案，才可开通服务。阿里云ICP代备案管理系统为您提供申请备案、修改注销备案信息、认领备案等服务。
网站为什么要备案？</p> <p>国家对互联网信息服务实行备案制度。国内的网站一律需要备案，否则不让开通。国家工信部要求中国境内（香港、澳门、台湾除外）所有服务器、网站空间供应商对于没有备案的域名一律不允许绑定到服务器。</p> <p>备案后的网站搜索引擎在seo方面会有一定考虑，且可以用cdn加速，加快网站访问速度。</p> <p>也就是说，虽然我们在阿里云后台设置了域名解析，但如果网站不进行备案，用户还是无法使用域名进行访问网站，备案号，可以更好地被各大搜索引擎收录。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/87b4eb58d0c643058d6f99715b55327a.png" alt="Django搭建深度日记：ICP 备案一"></p> <p>设置域名解析</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/ffc478ea99f442788b3914209ed7c34d.png" alt="Django搭建深度日记：ICP 备案一"></p> <p>无法访问网站</p> <h3 id="开始icp备案">开始ICP备案</h3> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/a15c0203339141168f01e656f5c8a83f.png" alt="Django搭建深度日记：ICP 备案一"></p> <p>开始备案</p> <p><a href="https://beian.aliyun.com/pcContainer/myorder" target="_blank" rel="noopener noreferrer">阿里云登录 - 欢迎登录阿里云，安全稳定的云计算服务平台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>开始备案后，一路填写相关信息</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/afd909b3ef0242f29b7e724f72797f46.png" alt="Django搭建深度日记：ICP 备案一"></p> <p>个人相关信息填写完毕后，再使用app上传相关资料</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/71a14a7f1c9548bc96af17cd1b44084b.jpg" alt="Django搭建深度日记：ICP 备案一"></p> <p>核对提交信息</p> <p>到了这一步，该提交的资料都已经完成，就是这么简单！接下来就是等待阿里云初审了。</p> <hr> <p>值得注意的是：网站开通后，需要在首页底部中间位置放置我们的ICP备案号并链接至“beian.miit.gov.cn”, 并在开通之日起30日内登陆全国互联网安全管理平台提交公安联网备案申请，获取《公安备案信息填写指南》。</p> <p>期待下一节，分享备案成功后的喜悦！！！哈哈</p> <h3 id="备案信息被驳回">备案信息被驳回</h3> <p>备案过程中，这边有一个信息不符合被驳回一次：网站名称：深度日记官方账号，驳回的理由，就是个人备案，不能带官方账号等字眼。因此，更新后重新提交了。</p> <h3 id="电话核验信息">电话核验信息</h3> <p>提交域名备案后，一定要留意手机，阿里云工作小妹妹会电话你进行信息确认。</p> <p>这边还挺感动的，是周日收到电话通知的。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/9bf0391b2e7644f3a741bc1e67731517.png" alt="Django搭建深度日记：ICP 备案二"></p> <p>备案流程</p> <h3 id="到工信部进行短信验证">到工信部进行短信验证</h3> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/3d7973eb725f47fc85e4374fb3573fe8.png" alt="Django搭建深度日记：ICP 备案二"></p> <p>阿里云初审后，需要登入工信部进行验证</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/dacec9ea103947aa8f5e15437918190e.png" alt="Django搭建深度日记：ICP 备案二"></p> <p>最后一步就是管局审核了</p> <h3 id="管理局审核通过">管理局审核通过</h3> <p>漫长的等待后，其实也就是一周的时间了，终于收到了管局的邮件：</p> <p>您的ICP备案申请已通过审核，备案/许可证编号为：浙ICP备2022003145号，审核通过日期：2022-01-28。特此通知！【工信部ICP备案】</p> <p>这是个幸福指数很高的邮件，哈哈！</p> <h3 id="将备案号添加到网页">将备案号添加到网页</h3> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/2a4c1c2cf41647468b6f313bcf935c77.png" alt="Django搭建深度日记：ICP 备案二"></p> <p>将备案号添加到网站底部</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;footer class=&quot;main-footer&quot;&gt;
    &lt;strong&gt;Copyright © 2021-2022 &lt;a href=&quot;https://www.deep-diary.com&quot;&gt;www.deep-diary.com&lt;/a&gt;.&lt;/strong&gt;
    All rights reserved.
    &lt;a href=&quot;http://beian.miit.gov.cn/&quot;&gt;浙ICP备2022003145号&lt;/a&gt;
&lt;/footer&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="更改服务器配置">更改服务器配置</h3> <p>更改nginx配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /etc/nginx/sites-available
cat deep-diary.com 
root@deep-diary:/etc/nginx/sites-available# cat deep-diary.com 
server {
  charset utf-8;
  listen 80;
  server_name www.deep-diary.com;  # 从IP 改成域名(修改一)

  location /static {
    alias /home/deep_diary/collected_static;
  }

  location /media {
    alias /home/deep_diary/media;
  }

  location / {
    proxy_set_header Host $host;
    proxy_pass http://unix:/tmp/www.deep-diary.com.socket;  # 从IP 改成域名(修改二)
  }
}
root@deep-diary:/etc/nginx/sites-available# 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>重启nginx服务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>service nginx reload   如果nginx 有所更改，需要执行此命令进行重新加载
gunicorn --bind unix:/tmp/www.deep-diary.com.socket deep_diary.wsgi:application # 重新绑定gunicorn
# (修改三)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>注意：</strong></p> <p>如果gunicorn 无法启动成功，可能是没有进入虚拟环境中执行的原因，</p> <p>因此，我们需要进入网站目录，执行<em>source env/bin/activate</em> 启用虚拟环境，这个时候，命令行前面会多出（env），再按如下代码启动即可</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>root@deep-diary:/etc# gunicorn --bind unix:/tmp/www.deep-diary.com.socket deep_diary.wsgi:application
Traceback (most recent call last):
  File &quot;/usr/bin/gunicorn&quot;, line 5, in &lt;module&gt;
    from gunicorn.app.wsgiapp import run
ModuleNotFoundError: No module named 'gunicorn'
root@deep-diary:/etc# cd /home/deep_diary/
root@deep-diary:/home/deep_diary# source env/bin/activate
(env) root@deep-diary:/home/deep_diary# gunicorn --bind unix:/tmp/www.deep-diary.com.socket deep_diary.wsgi:application
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="成果展示">成果展示：</h3> <p>打完收工，一起来看下效果吧</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/6f23861dafd54fd78be0154800869d3e.png" alt="Django搭建深度日记：ICP 备案二"></p> <p>终于可以使用这个域名进行访问了</p> <h3 id="域名解析">域名解析</h3> <p>备案号后，就可以正常使用域名进行访问了。当然，我们还可以创建二级域名，具体操作方式就是进入域名管理后台，添加相关记录，这个新的二级域名，可以指向不同的<code>IP</code>，也就是下图的记录值。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1650634596878.png" alt="1650634596878"></p> <h2 id="大文件上传">大文件上传</h2> <h3 id="问题描述">问题描述</h3> <p>在服务器上部署好网站好，开始准备尝试上传照片，结果报了一个403错误：上传的内容太大了。。。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/c26f2f2ce6f34f5da24e0ee817861907.png" alt="Django搭建深度日记：问题清单-草根网站的痛点"></p> <h3 id="解决措施">解决措施</h3> <p>1.打开nginx配置文件 nginx.conf, 路径一般是：/etc/nginx/nginx.conf。</p> <p>2.在http{}段中加入 <strong>client_max_body_size 200m</strong>; 200m为允许最大上传的大小。</p> <p>3.保存后重启nginx，问题解决。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/4c7cf80d345f4295886edb5116d25e4f.png" alt="Django搭建深度日记：问题清单-草根网站的痛点"></p> <p>增加上传最大容量的设置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>root@deep-diary:/etc# cd nginx/
root@deep-diary:/etc/nginx# vi nginx.conf 
root@deep-diary:/etc/nginx# ../init.d/nginx restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="抛出的新问题">抛出的新问题</h3> <p>草根网站图片上传问题解决了，但由于上传的是原图，展示太卡，完全不可接受！</p> <h3 id="解决措施-2">解决措施</h3> <ol><li>使用cdn 对静态资源加速</li> <li>使用对象存储服务器，把图片保存到存储服务器中</li> <li>上传图片的时候，对图片进行压缩</li></ol> <h2 id="oss对象存储">oss对象存储</h2> <p>上一章我们实现了网站的域名绑定，可以通过域名进行网页访问，但有一个头疼的问题是，图片资源动不动就好几个M，加载一张图片等地真心累，这样用户早就跑完了。</p> <p>关于网站优化，有如下几个方法：</p> <ol><li>将图片等媒体文件放到oss服务器上</li> <li>将静态文件放到oss服务器上或者使用cdn服务器进行加载</li></ol> <p>本章先简单介绍下oss服务器。</p> <h3 id="什么是oss对象存储">什么是oss对象存储</h3> <p>对象存储服务（Object Storage Service，简称 OSS）为您提供基于网络的数据存取服务。使用 OSS，您可以通过网络随时存储和调用包括文本、图片、音频和视频等在内的各种非结构化数据文件。</p> <h3 id="为什么要使用oss对象存储">为什么要使用oss对象存储</h3> <p>对象存储可以简单理解为用来存储图片、音频、视频等非结构化数据的数据池。相对于主机服务器，具有读写速度快，利于分享的特点</p> <p>阿里云OSS:海量、安全、低成本、高可靠的云存储服务，提供99.9999999999%的数据可靠性。使用RESTful API 可以在互联网任何位置存储和访问，容量和处理能力弹性扩展</p> <p>1、网站数据动静分离，大幅提升网页性能</p> <p>一般情况下，我们都是建议使用主机服务器和对象存储分工合作的方式来存储网站数据。主机服务器主要负责存储网站的动态数据，对象存储则用来存储网站的静态文件。从而实现网站的动静分离，当用户访问一个网站时，分别从主机服务器和对象存储的服务器同步读取数据，可以大幅的提升网页性能。</p> <p>2、单独的文件管理界面，管理网站文件和本地电脑一样方便</p> <p>无论是腾讯云、阿里云、杉岩，对象存储都有单独的管理控制台，腾讯云和阿里云还有专门的电脑客户端。你不必打开网站，就可以像使用百度云盘一样使用对象存储来管理你的网站文件，除了上传、下载、预览等常用功能，还可以直接在对象存储上进行图片处理/媒体转码/数据分析等。</p> <p>3、本质是”内置大容量硬盘的分布式服务器“，同一个文件支持跨域共享</p> <p>对象存储的本质是“内置大容量硬盘的分布式服务器”，对象存储有自己的 CPU、内存、网络和磁盘系统，具备一定的智能，同一个对象存储数据池可以新建不同的存储桶（bucket），分别用来存储不同网站的数据，彼此互不干扰。而且同一个文件可以引用到不同的网站，可以有效的减少数据冗余。</p> <p>4、储存节点多，支持跨地域实时同步，实现异地容灾</p> <p>假设你的图片等数据存储在你自己的服务器上，只能通过定期数据备份的方式保护你的数据。数据量大的话，每次备份都需要大量的时间和占用大量的磁盘空间，管理起来还不方便。</p> <p>如果你的数据放置在对象存储的数据池了，并与网站关联。那么静态文件的备份就可以交给对象存储。你只需要对网站少量的动态文件进行备份。省时省力。</p> <p>比如我使用对象存储，我在离我最近的节点【深圳】来存储网站的图片等静态文件。但是考虑到极端情况，比如深圳节点由于突然停电，可能导致数据全部丢失。但如果之前我选择了【杭州】作为第二个存储节点，而且设置【深圳】节点的数据实时增量同步到【杭州】节点。那么就算深圳节点的数据丢失了，但是我在杭州的数据还是可以使用。等到恢复供电，我再把数据从杭州节点同步回深圳节点就可以了。这就是我们说的异地容灾。</p> <p>5、成本低，资源弹性伸缩，按需付费</p> <p>对象存储不像服务器的流量是固定的，包含在服务器的费用里面了。无论你用或不用，都是这么多。对象存储可以是根据你的实际使用量进行计费。</p> <p>6、节省服务器空间</p> <p>为什么选择将这一点放在最后说呢？因为现在服务器的价格还算实惠，活动也比较多。大部分站长已经不存在服务器空间不够用的问题。而且对象存储的出现也不是为了解决服务器空间不够用的问题。而是为了结合【块存储】、【文件存储】各自的优点，从而实现高效的文件读写和分享。但是节省了服务器空间还是不争得事实，所以还是提一下吧。
以上内容转载，原文详解末尾链接</p> <h3 id="阿里云oss的相关配置">阿里云oss的相关配置</h3> <h4 id="创建bucket">创建bucket</h4> <p>这里的bucket就是所谓的存储空间，可以理解成云盘的根目录</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1644409424161.png" alt="1644409424161"></p> <h4 id="配置bucket">配置Bucket</h4> <p>由于是个人网站，很多用户都可以查阅，因此这里的读写权限选择公共读。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1644409506089.png" alt="1644409506089"></p> <h4 id="上传文件到oss服务器">上传文件到oss服务器</h4> <p>这里仅仅作为测试，后续肯定会用python实现自动上传相关媒体文件到服务器。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1644409845284.png" alt="1644409845284"></p> <h4 id="从服务器中获取照片">从服务器中获取照片</h4> <p><strong>示例代码</strong></p> <p>以下代码用于将examplebucket中testfolder目录下的exampleobject.txt下载到本地D:\localpath路径下的examplefile.txt。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> oss2

<span class="token comment"># 阿里云账号AccessKey拥有所有API的访问权限，风险很高。强烈建议您创建并使用RAM账号进行API访问或日常运维，请登录RAM控制台创建RAM账号。</span>
auth <span class="token operator">=</span> oss2<span class="token punctuation">.</span>Auth<span class="token punctuation">(</span><span class="token string">'yourAccessKeyId'</span><span class="token punctuation">,</span> <span class="token string">'yourAccessKeySecret'</span><span class="token punctuation">)</span>
<span class="token comment"># Endpoint以杭州为例，其它Region请按实际情况填写。</span>
<span class="token comment"># 填写Bucket名称，例如examplebucket。</span>
bucket <span class="token operator">=</span> oss2<span class="token punctuation">.</span>Bucket<span class="token punctuation">(</span>auth<span class="token punctuation">,</span> <span class="token string">'http://oss-cn-hangzhou.aliyuncs.com'</span><span class="token punctuation">,</span> <span class="token string">'examplebucket'</span><span class="token punctuation">)</span>

<span class="token comment"># 填写Object完整路径，完整路径中不包含Bucket名称，例如testfolder/exampleobject.txt。</span>
<span class="token comment"># 下载Object到本地文件，并保存到指定的本地路径D:\\localpath\\examplefile.txt。如果指定的本地文件存在会覆盖，不存在则新建。</span>
bucket<span class="token punctuation">.</span>get_object_to_file<span class="token punctuation">(</span><span class="token string">'testfolder/exampleobject.txt'</span><span class="token punctuation">,</span> <span class="token string">'D:\\localpath\\examplefile.txt'</span><span class="token punctuation">)</span>        
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>这里的bucket，就是阿里云存储对象，有很多属性，也可以对这个对象进行分页操作，同时，这个对象也有很多方法，比如上传，下载图片等，具体详解文章末尾链接的官网教程</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1644419847400.png" alt="1644419847400"></p> <h4 id="django-配置阿里云oss">Django 配置阿里云oss</h4> <h5 id="安装依赖包">安装依赖包</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip install oss2
pip install django-oss-storage
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="添加-oss-配置">添加 oss 配置</h4> <p>在settings.py 中添加 oss 配置，配置完毕后就会生效, 上传地址, 访问路径都会变成 oss 服务器上的</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>MEDIA_URL <span class="token operator">=</span> <span class="token string">'/media/'</span>
MEDIA_ROOT <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'media'</span><span class="token punctuation">)</span>
OSS_ACCESS_KEY_ID <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>  
OSS_ACCESS_KEY_SECRET <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>   
OSS_ENDPOINT <span class="token operator">=</span> <span class="token string">&quot;oss-accelerate.aliyuncs.com&quot;</span>      <span class="token comment"># 访问域名, 根据服务器上的实际配置修改</span>
OSS_BUCKET_NAME <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>    <span class="token comment"># oss 创建的 BUCKET 名称</span>

<span class="token comment"># 添加下面配置后 Django admin 后台上传的 ImageField, FileField 类型的字段都会被自动上传到 oss 的服务器中, 访问路径也会自动替换# 如果注释掉的话 oss 的配置会失效, 上传文件会存储到本地, 且访问路径也会变成本地</span>
DEFAULT_FILE_STORAGE <span class="token operator">=</span> <span class="token string">'django_oss_storage.backends.OssMediaStorage'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="文件上传路径说明">文件上传路径说明</h4> <p>如果开始设计的时候，是使用的本地media目录，现在无非就是把这个默认存储空间，转移到了阿里云bucket中的media目录，其它均可以保持不变。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1645532036150.png" alt="1645532036150"></p> <h4 id="监听相关操作">监听相关操作</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Base</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    image <span class="token operator">=</span> models<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">&quot;图片文件&quot;</span><span class="token punctuation">,</span> upload_to<span class="token operator">=</span><span class="token string">&quot;base/image/&quot;</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 该表删除操作时监听</span>

<span class="token decorator annotation punctuation">@receiver</span><span class="token punctuation">(</span>post_delete<span class="token punctuation">,</span> sender<span class="token operator">=</span>Base<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete_upload_files</span><span class="token punctuation">(</span>sender<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 删除 oss仓库 图片</span>
    files <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> files<span class="token punctuation">:</span>
        <span class="token keyword">return</span>

    <span class="token comment"># 连接 oss </span>
    auth <span class="token operator">=</span> oss2<span class="token punctuation">.</span>Auth<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>OSS_ACCESS_KEY_ID<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>OSS_ACCESS_KEY_SECRET<span class="token punctuation">)</span>
    <span class="token comment"># 获取 bucket </span>
    bucket <span class="token operator">=</span> oss2<span class="token punctuation">.</span>Bucket<span class="token punctuation">(</span>auth<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>OSS_ENDPOINT<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>OSS_BUCKET_NAME<span class="token punctuation">)</span>
    <span class="token comment"># 删除文件</span>
    bucket<span class="token punctuation">.</span>delete_object<span class="token punctuation">(</span>files<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>


<span class="token comment"># 该表更新/创建操作时监听</span>

<span class="token decorator annotation punctuation">@receiver</span><span class="token punctuation">(</span>post_save<span class="token punctuation">,</span> sender<span class="token operator">=</span>Base<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">save_upload_files</span><span class="token punctuation">(</span>sender<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 更新 oss仓库 图片</span>
    files <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> files<span class="token punctuation">:</span>
        <span class="token keyword">return</span>
<span class="token comment"># 要对图片进行处理的样式</span>
style1 <span class="token operator">=</span> <span class="token string">&quot;image/crop,x_10,y_10,w_200,h_200,g_se&quot;</span>
style2 <span class="token operator">=</span> <span class="token string">'image/resize,w_700,h_260,m_lfit'</span>
style3 <span class="token operator">=</span> <span class="token string">'image/resize,m_fixed,h_260,w_700'</span>

auth <span class="token operator">=</span> oss2<span class="token punctuation">.</span>Auth<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>OSS_ACCESS_KEY_ID<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>OSS_ACCESS_KEY_SECRET<span class="token punctuation">)</span>
bucket <span class="token operator">=</span> oss2<span class="token punctuation">.</span>Bucket<span class="token punctuation">(</span>auth<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>OSS_ENDPOINT<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>OSS_BUCKET_NAME<span class="token punctuation">)</span>
process <span class="token operator">=</span> <span class="token string">&quot;{0}|sys/saveas,o_{1},b_{2}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>style<span class="token punctuation">,</span>
                                              oss2<span class="token punctuation">.</span>compat<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>urlsafe_b64encode<span class="token punctuation">(</span>
                                                  oss2<span class="token punctuation">.</span>compat<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                              oss2<span class="token punctuation">.</span>compat<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>urlsafe_b64encode<span class="token punctuation">(</span>
                                                  oss2<span class="token punctuation">.</span>compat<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>OSS_BUCKET_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 更新文件</span>
bucket<span class="token punctuation">.</span>process_object<span class="token punctuation">(</span>files<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> process<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="小结">小结</h3> <p>现在图片等媒体文件可以上传到oss对象服务器了，是不是网站的访问速度就可以大大提高了呢？答案是有一定的作用，但还可以优化提速。</p> <p>我们知道服务器加载静态资源还是蛮费时间的，学习了本章，是否可以考虑把静态资源也搬到oss上呢？</p> <p>另外CDN也可以加快网站的访问速度，但具体快多少呢？下一节将揭晓答案。</p> <h3 id="扩展阅读">扩展阅读</h3> <p><a href="https://gosspublic.alicdn.com/image/index.html?spm=a2c4g.11186623.0.0.7d203871dQExI3" target="_blank" rel="noopener noreferrer">OSS图片处理6.0 (alicdn.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://help.aliyun.com/document_detail/47660.html" target="_blank" rel="noopener noreferrer">OSS SDK 图片处理 (aliyun.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/Doudou_Mylove/article/details/107221109" target="_blank" rel="noopener noreferrer">为什么需要使用oss对象存储<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[Django 配置阿里云oss]( <a href="https://www.cnblogs.com/chaoqi/p/13903371.html" target="_blank" rel="noopener noreferrer">python - Django 配置阿里云 oss - _Q - 博客园 (cnblogs.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> )</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1644410042333.png" alt="1644410042333">创建</p> <h3 id="网站加速">网站加速</h3> <p>上一章我们将了提高网站访问速度的<code>2个方法</code>：</p> <ol><li>将图片等媒体文件放到oss服务器上</li> <li>将静态文件放到oss服务器上或者使用cdn服务器进行加载</li></ol> <p>本章我们来聊一聊如何优化网站的静态资源文件。</p> <p>优化静态资源文件方法有很多，这里介绍2种方法：</p> <ol><li>将静态文件放到oss服务器上</li> <li>使用CDN服务器进行加载</li></ol> <h4 id="网站加速原理">网站加速原理</h4> <p>我们传统网站，会把web服务器，静态资源，动态资源，媒体文件，都放在一个服务器中，因此加载就特别吃力，也无法解决地域问题（比如上海用户访问美国网站）</p> <h5 id="把各个资源独立开来">把各个资源独立开来</h5> <p>那样就不会那么拥挤，比如把如下每类资源，都放在独立的服务器上</p> <ul><li>web服务器</li> <li>oss对象服务器</li> <li>静态资源服务器（css，js）</li> <li>动态资源服务器，这里主要指数据库了</li></ul> <h5 id="把静态资源缓存到世界各地">把静态资源缓存到世界各地</h5> <p>这样一来，用户就可以实现就近访问，实现加速，这就是大名鼎鼎的CDN原理</p> <p>接下来我们就来了解下上述两种方法的具体实现过程吧。</p> <h4 id="静态资源保存到oss服务器">静态资源保存到oss服务器</h4> <p>这里还是以阿里云为例</p> <h5 id="_1-安装依赖包">1. 安装依赖包</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>pip install oss2
pip install django-oss-storage
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="添加-oss-配置-2">添加 oss 配置</h5> <p>在<code>settings.py</code> 中添加 <code>oss</code>配置，以下配置完毕后就会生效, 上传地址, 访问路径都会变成 <code>oss</code>服务器上的,</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># settings.py </span>
OSS_ACCESS_KEY_ID <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>  
OSS_ACCESS_KEY_SECRET <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>   
OSS_ENDPOINT <span class="token operator">=</span> <span class="token string">&quot;oss-accelerate.aliyuncs.com&quot;</span>  <span class="token comment"># 访问域名, 根据服务器上的实际配置修改</span>
OSS_BUCKET_NAME <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>    <span class="token comment"># oss 创建的 BUCKET 名称</span>

<span class="token comment"># 设置上传的静态文件，需要上传静态文件的记得添加此项</span>
STATICFILES_STORAGE <span class="token operator">=</span> <span class="token string">'django_oss_storage.backends.OssStaticStorage'</span>
STATIC_URL <span class="token operator">=</span> <span class="token string">'/static/'</span>
STATIC_ROOT <span class="token operator">=</span> <span class="token string">'static'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="文件上传路径说明-2">文件上传路径说明</h5> <p>如果开始设计的时候，是使用的本地static目录，现在无非就是把这个默认存储空间，转移到了阿里云bucket中的static目录，其它均可以保持不变。</p> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/1645534845185.png" alt="1645534845185"></p> <p>这个操作可以理解为：当你加载一个网页的时候，静态资源从oss服务器过来，web数据从web服务器过来，类似多路并行加载，可以一定程度提高速度。</p> <h5 id="常见问题">常见问题</h5> <p>刚把静态资源上传到阿里云oss后，遇到了如下这个问题：</p> <p><strong>OSS跨域资源共享（CORS）出现报错的排查方法</strong>，解决办法可以参考如下链接</p> <p><a href="https://help.aliyun.com/document_detail/44199.html" target="_blank" rel="noopener noreferrer">OSS跨域资源共享（CORS）出现报错的排查方法 (aliyun.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="使用cdn进行网站加速">使用CDN进行网站加速</h4> <p>将静态我呢见保存到oss服务器中，一定程度上是可以加速网站，但还是无法解决一个问题，就是oss服务器在广州，用户在北京，物理距离免不了会产生一些时延。</p> <p>理想解决方案就是用户网文网页时，可以从北京附近的服务器加载相关资源文件，这就是CDN 的概念</p> <h5 id="什么是cdn">什么是CDN</h5> <p>CDN的全称是Content Delivery Network，即内容分发网络。其目的是通过在现有的Internet中增加一层新的网络架构，将网站的内容发布到最接近用户的网络“边缘”，使用户可以就近取得所需的内容，提高用户访问网站的响应速度。</p> <h5 id="为什么要使用-cdn">为什么要使用 CDN？</h5> <ul><li>页面卡顿</li> <li>高并发情况下服务器压力大</li></ul> <h5 id="cdn-访问的两阶段">CDN 访问的两阶段</h5> <ol><li>域名解析</li> <li>内容请求</li></ol> <p><img src="https://deep-diary.oss-cn-hangzhou.aliyuncs.com/blog/cdn.png" alt="CDN 访问的两阶段"></p> <ol><li>使用云端的静态资源 （能够解决国外网站访问慢的问题）</li> <li>使用 CDN 加速</li></ol> <h5 id="免费的cdn资源网站">免费的CDN资源网站</h5> <p>首屈一指的就是要推荐下面这个CDNJS了，原因很简单，在服务相对稳定下，它的的JS库是最完整的，很多很好的CDN都是同步它的仓库，这个直接导致其它大CDN服务商，都有JSLite 库了，太赞了。</p> <p><strong>CDNJS</strong></p> <p>CDNJS提供非常完整的 JavaScript 库，无论是热门或是冷门的一应俱全。若你觉得它们缺少哪些好用的函式库，也可以自行提交到网站里，通过审核后就 CDNJS 就会为你分流 js文件！这项服务是结合 CloudFlare、Pingdom 与 S3Stat的，稳定性与速度自然不在话下。CDNJS提供的 JavaScript Libraries 全部列在网站首页，使用者可以直接搜索。这些JS库都有标示版本编号、标签以及原维护网站链结。</p> <p>官网：http://www.cdnjs.com/</p> <p><strong>BootCDN</strong></p> <p>BootCDN 是 Bootstrap中文网支持并维护的开源项目免费 CDN 服务，致力于为 Bootstrap、jQuery、Angular 一样优秀的开源项目提供稳定、快速的免费 CDN 服务。BootCDN 所收录的开源项目主要同步于 cdnjs 仓库。</p> <p>官网：http://www.bootcdn.cn/</p> <p>本网站大部分使用bootCDN，如果您的网站正好用了AdminLTE，那如下这些CDN资源就再适合你不过了。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- web icon --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shortcut  icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://deep-diary.oss-cn-hangzhou.aliyuncs.com/media/sys_img/sys_img/favicon.ico<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/x-icon<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- Google Font: Source Sans Pro --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&amp;display=fallback<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- Font Awesome Icons --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- adminlte Theme style --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/admin-lte/3.2.0-rc/css/adminlte.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/admin-lte/3.2.0-rc/css/alt/adminlte.components.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/admin-lte/3.2.0-rc/css/alt/adminlte.core.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/admin-lte/3.2.0-rc/css/alt/adminlte.extra-components.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/admin-lte/3.2.0-rc/css/alt/adminlte.pages.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/admin-lte/3.2.0-rc/css/alt/adminlte.plugins.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 通知提醒样式 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/layer/3.5.1/mobile/need/layer.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 极简滚动条插件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/overlayscrollbars/1.13.1/css/OverlayScrollbars.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 国旗图标 flag-icon-css --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{% static <span class="token punctuation">'</span>plugins/flag-icon-css/css/flag-icon.min.css<span class="token punctuation">'</span> %}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--  鼠标悬停--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/hover.css/2.3.1/css/hover-min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/imagehover.css/2.0.0/css/imagehover.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- icheck bootstrap --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/icheck-bootstrap/3.0.1/icheck-bootstrap.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>更多免费CDN网站，详解扩展阅读链接</p> <h4 id="小结-2">小结</h4> <p>对于使用一些免费的CDN资源，往往会出现无法加载的现场，有时候甚至没有从本地加载静态资源快，下一章，我们就用实验数据，分别测试下如下三种方法，到底哪种更快，快多少？</p> <h4 id="扩展阅读-2">扩展阅读：</h4> <p><a href="https://zhuanlan.zhihu.com/p/52362950" target="_blank" rel="noopener noreferrer">到底什么是CDN？ - 知乎 (zhihu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://cloud.tencent.com/developer/article/1355006" target="_blank" rel="noopener noreferrer">推荐13个常用前端公共库CDN服务资源 - 云+社区 - 腾讯云 (tencent.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://suyin-blog.club/2021/3RZJTFE/" target="_blank" rel="noopener noreferrer">Django - 让网站访问更快 | 苏寅 Blog (suyin-blog.club)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/215753846" target="_blank" rel="noopener noreferrer">什么是CDN，有什么作用 - 知乎 (zhihu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">11/25/2022, 10:40:46 PM</span></div></footer> <!----> <!----></main> <!----> <div class="comments-wrapper" data-v-4698c43e><!----></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><!----><div></div><!----><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://music.163.com/song/media/outer/url?id=316756.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://p2.music.126.net/qOOTIykbSLw9RHB0vI83GA==/737772302281958.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://p2.music.126.net/qOOTIykbSLw9RHB0vI83GA==/737772302281958.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>大城小事</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>杨千嬅</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----></div></div>
    <script src="/assets/js/app.6f3ddf89.js" defer></script><script src="/assets/js/4.ddcf94e0.js" defer></script><script src="/assets/js/1.dee964bb.js" defer></script><script src="/assets/js/47.75781b4a.js" defer></script><script src="/assets/js/10.51e38269.js" defer></script>
  </body>
</html>
